# دفترچه تست سیستم طلاملا v4 — Test Playbook

> این سند شامل سناریوهای تست دقیق برای QA سیستم TalaMala v4 است.
> هر تست دارای شناسه یکتا، اقدام، ورودی، نتیجه مورد انتظار و ستون وضعیت است.

---

## فهرست مطالب

1. [پیش‌نیازها و داده‌های تست](#1-پیشنیازها-و-دادههای-تست)
2. [TS-01: احراز هویت (Auth)](#2-ts-01-احراز-هویت)
3. [TS-02: فروشگاه (Shop)](#3-ts-02-فروشگاه)
4. [TS-03: سبد خرید (Cart)](#4-ts-03-سبد-خرید)
5. [TS-04: ثبت سفارش (Checkout & Order)](#5-ts-04-ثبت-سفارش)
6. [TS-05: پرداخت (Payment)](#6-ts-05-پرداخت)
7. [TS-06: کیف پول (Wallet)](#7-ts-06-کیف-پول)
8. [TS-07: کوپن (Coupon)](#8-ts-07-کوپن)
9. [TS-08: پنل مدیریت (Admin)](#9-ts-08-پنل-مدیریت)
10. [TS-09: نمایندگان (Dealer)](#10-ts-09-نمایندگان)
11. [TS-10: احراز اصالت (Verification)](#11-ts-10-احراز-اصالت)
12. [TS-11: پروفایل و آدرس (Profile & Address)](#12-ts-11-پروفایل-و-آدرس)
13. [TS-12: تیکتینگ / پشتیبانی (Ticket)](#13-ts-12-تیکتینگ--پشتیبانی)
14. [TS-13: POS REST API نماینده](#14-ts-13-pos-rest-api-نماینده)
15. [TS-14: بازپرداخت اجرت بازخرید (Buyback Wage Refund)](#15-ts-14-بازپرداخت-اجرت-بازخرید)
16. [TS-15: صفحات ثابت و فوتر (Static Pages & Footer)](#16-ts-15-صفحات-ثابت-و-فوتر)
17. [TS-16: ثبت مالکیت، خرید هدیه و انتقال شمش (Bar Claim & Transfer)](#17-ts-16-ثبت-مالکیت-خرید-هدیه-و-انتقال-شمش)
18. [TS-18: مدیریت کاربران (Customer Management)](#18-ts-18-مدیریت-کاربران-customer-management)
19. [TS-19: انتخاب بسته‌بندی مشتری (Customer Package Selection)](#19-ts-19-انتخاب-بستهبندی-مشتری-customer-package-selection)
20. [TS-20: چند درگاه پرداخت (Multi-Gateway Payment)](#20-ts-20-چند-درگاه-پرداخت-multi-gateway-payment)
21. [TS-21: درخواست نمایندگی (Dealer Request)](#21-ts-21-درخواست-نمایندگی-dealer-request)
22. [TS-22: پیگیری تحویل فیزیکی و طلای امانی (Bar Delivery Tracking & Custodial Gold)](#22-ts-22-پیگیری-تحویل-فیزیکی-و-طلای-امانی-bar-delivery-tracking--custodial-gold)
23. [TS-23: نظرات و پرسش‌وپاسخ محصول (Reviews & Comments)](#23-ts-23-نظرات-و-پرسشوپاسخ-محصول-reviews--comments)
24. [TS-24: API دستگاه POS مشتری‌محور (Customer-Facing POS API)](#24-ts-24-api-دستگاه-pos-مشتریمحور-customer-facing-pos-api)
25. [TS-25: یکپارچه‌سازی دستگاه POS راسیس (Rasis POS Integration)](#25-ts-25-یکپارچهسازی-دستگاه-pos-راسیس-rasis-pos-integration)
26. [TS-26: قیمت‌گذاری چندفلزی (Metal-Aware Pricing)](#26-ts-26-قیمتگذاری-چندفلزی-metal-aware-pricing)
27. [TS-27: داشبورد B2B نمایندگان (Dealer B2B Dashboard)](#27-ts-27-داشبورد-b2b-نمایندگان-dealer-b2b-dashboard)
28. [TS-28: انبارگردانی پیشرفته و رهگیری فیزیکی (Advanced Inventory & Physical Tracking)](#28-ts-28-انبارگردانی-پیشرفته-و-رهگیری-فیزیکی-advanced-inventory--physical-tracking)
29. [TS-NEG: تست‌های منفی (Negative Tests)](#29-ts-neg-تستهای-منفی)

---

## 1. پیش‌نیازها و داده‌های تست

### محیط تست
```
python scripts/seed.py --reset
uvicorn main:app --reload
مرورگر: http://127.0.0.1:8000
```

### حساب‌های تست

| شناسه | نقش | موبایل | توضیح |
|--------|------|---------|--------|
| U1 | Super Admin | 09123456789 | دسترسی کامل |
| U2 | Operator | 09121111111 | عملیاتی |
| U3 | Customer | 09351234567 | کیف پول: ۱۰ میلیون تومان |
| U4 | Customer | 09359876543 | بدون موجودی |
| U5 | Customer | 09131112233 | — |
| D1 | Dealer | 09161234567 | نمایندگی اصفهان — پخش |
| D2 | Dealer | 09171234567 | نمایندگی شیراز — بنکدار |
| D3 | Dealer | 09181234567 | نمایندگی مشهد — فروشگاه |
| D4 | Dealer | 09141234567 | نمایندگی تبریز — پخش |
| D5 | Dealer | 09121234567 | شعبه میرداماد تهران — پخش |
| D6 | Dealer | 09122345678 | شعبه بازار ناصرخسرو — بنکدار |
| D7 | Dealer | 09123456780 | شعبه بازار اردیبهشت — بنکدار |
| D8 | Dealer | 09124567890 | شعبه شهرک غرب — فروشگاه |
| D9 | Dealer | 09125678901 | شعبه کریمخان — فروشگاه |

### کوپن‌های تست

| شناسه | کد | نوع | توضیح |
|--------|------|------|--------|
| C1 | WELCOME10 | ۱۰٪ تخفیف | اولین خرید |
| C2 | CASHBACK5 | ۵٪ کشبک | واریز به کیف پول |
| C3 | FIXED500 | ۵۰۰ هزار تومان | حداقل سفارش ۵ میلیون |
| C4 | VIP2026 | ۱۵٪ تخفیف | فقط موبایل‌های خاص |

### کد OTP در محیط تست
در حالت توسعه، کد OTP ثابت `111111` است.

---

## 2. TS-01: احراز هویت

| ID | اقدام | ورودی | نتیجه مورد انتظار | وضعیت |
|----|--------|-------|-------------------|--------|
| TS-01-01 | باز کردن صفحه لاگین | مرورگر → `/auth/login` | فرم ورود با فیلد موبایل نمایش داده شود | ☐ |
| TS-01-02 | درخواست OTP برای ادمین | موبایل: `09123456789` | پیام «کد ارسال شد» + ریدایرکت به فرم OTP | ☐ |
| TS-01-03 | تایید OTP ادمین | کد: `111111` | ریدایرکت به `/admin/dashboard` | ☐ |
| TS-01-04 | درخواست OTP برای مشتری | موبایل: `09351234567` | پیام «کد ارسال شد» | ☐ |
| TS-01-05 | تایید OTP مشتری | کد: `111111` | ریدایرکت به `/` (صفحه اصلی فروشگاه) | ☐ |
| TS-01-06 | لاگین نماینده | موبایل نماینده + OTP `111111` | ریدایرکت به `/dealer/dashboard` | ☐ |
| TS-01-07 | خروج (Logout) | کلیک روی «خروج» | ریدایرکت به `/auth/login` + حذف کوکی | ☐ |
| TS-01-08 | لاگین مشتری جدید | موبایل: `09199999999` + OTP | حساب مشتری جدید ایجاد شود + ریدایرکت به `/` | ☐ |
| TS-01-09 | OTP اشتباه | کد: `000000` | پیام خطا «کد نادرست» | ☐ |
| TS-01-10 | موبایل نامعتبر | موبایل: `1234` | ارسال نشود / خطای اعتبارسنجی | ☐ |

---

## 3. TS-02: فروشگاه

| ID | اقدام | ورودی | نتیجه مورد انتظار | وضعیت |
|----|--------|-------|-------------------|--------|
| TS-02-01 | صفحه اصلی فروشگاه | مرورگر → `/` | لیست محصولات با قیمت نمایش شود | ☐ |
| TS-02-02 | فیلتر دسته‌بندی | کلیک روی یک دسته‌بندی | فقط محصولاتی که آن دسته‌بندی را دارند نمایش شوند (M2M — محصولات چنددسته‌بندی‌ای در نتایج ظاهر می‌شوند) | ☐ |
| TS-02-02a | فیلتر دسته‌بندی — محصول چنددسته‌بندی | محصولی با ۲ دسته‌بندی (A و B) → فیلتر روی A | محصول در نتایج نمایش شود + فیلتر روی B هم آن محصول را نشان دهد | ☐ |
| TS-02-03 | مرتب‌سازی ارزان‌ترین | انتخاب «ارزان‌ترین» | محصولات به ترتیب قیمت صعودی | ☐ |
| TS-02-04 | مرتب‌سازی گران‌ترین | انتخاب «گران‌ترین» | محصولات به ترتیب قیمت نزولی | ☐ |
| TS-02-05 | صفحه جزئیات محصول | کلیک روی یک محصول | نمایش: نام، وزن، عیار، ریز قیمت، تصویر، دکمه افزودن | ☐ |
| TS-02-06 | قیمت لحظه‌ای | تغییر قیمت طلا در تنظیمات (یا بروزرسانی از goldis.ir) → رفرش فروشگاه | قیمت‌ها بر اساس قیمت جدید محاسبه شوند | ☐ |
| TS-02-07 | محصول بدون موجودی | محصولی که شمش Assigned ندارد | نمایش «ناموجود» یا عدم نمایش دکمه خرید | ☐ |

---

## 4. TS-03: سبد خرید

**پیش‌نیاز**: لاگین به‌عنوان مشتری (U3: `09351234567`)

| ID | اقدام | ورودی | نتیجه مورد انتظار | وضعیت |
|----|--------|-------|-------------------|--------|
| TS-03-01 | افزودن به سبد | کلیک «افزودن به سبد» در صفحه محصول | محصول به سبد اضافه شود + تعداد سبد +۱ | ☐ |
| TS-03-02 | مشاهده سبد | مرورگر → `/cart` | لیست آیتم‌ها با قیمت و جمع کل | ☐ |
| TS-03-03 | تغییر تعداد | تغییر تعداد آیتم به ۲ | قیمت و جمع کل به‌روز شود | ☐ |
| TS-03-04 | حذف از سبد | کلیک «حذف» روی آیتم | آیتم حذف شود + جمع کل به‌روز شود | ☐ |
| TS-03-05 | سبد خالی | حذف همه آیتم‌ها | پیام «سبد خرید خالی است» | ☐ |
| TS-03-06 | افزودن بدون لاگین | بدون لاگین، کلیک «افزودن به سبد» | ریدایرکت به صفحه ورود | ☐ |

---

## 5. TS-04: ثبت سفارش

**پیش‌نیاز**: لاگین U3 + حداقل ۱ آیتم در سبد

| ID | اقدام | ورودی | نتیجه مورد انتظار | وضعیت |
|----|--------|-------|-------------------|--------|
| TS-04-01 | باز کردن چک‌اوت | مرورگر → `/checkout` | فرم تحویل + خلاصه سفارش | ☐ |
| TS-04-02 | انتخاب تحویل حضوری | انتخاب «حضوری» + انتخاب نمایندگی | نمایندگی‌ها در dropdown نمایش شوند | ☐ |
| TS-04-03 | انتخاب ارسال پستی | انتخاب «پستی» + وارد کردن آدرس | فیلدهای آدرس نمایش شوند + هزینه ارسال اضافه شود | ☐ |
| TS-04-04 | اعمال کوپن تخفیف | وارد کردن `WELCOME10` | تخفیف ۱۰٪ نمایش شود + مبلغ نهایی کاهش یابد | ☐ |
| TS-04-05 | اعمال کوپن کشبک | وارد کردن `CASHBACK5` | نوع کشبک نمایش شود (واریز پس از تحویل) | ☐ |
| TS-04-06 | ثبت سفارش حضوری | فرم کامل + کلیک «ثبت سفارش» | سفارش ایجاد شود با وضعیت Pending + ریدایرکت به جزئیات | ☐ |
| TS-04-07 | ثبت سفارش پستی | فرم کامل + آدرس + کلیک «ثبت سفارش» | سفارش با هزینه ارسال ایجاد شود | ☐ |
| TS-04-08 | رزرو شمش | ثبت سفارش | شمش مربوطه وضعیت Reserved بگیرد | ☐ |
| TS-04-09 | لغو سفارش توسط مشتری | سفارش Pending → «لغو سفارش» | وضعیت Cancelled + دلیل «لغو توسط مشتری» + تاریخ لغو نمایش شود | ☐ |
| TS-04-10 | لغو سفارش توسط مدیر | ادمین → سفارش Pending → «لغو» | وضعیت Cancelled + دلیل «لغو توسط مدیر سیستم» | ☐ |
| TS-04-11 | لغو خودکار (انقضای رزرو) | سفارش Pending بیش از ۱۵ دقیقه | وضعیت Cancelled + دلیل «عدم پرداخت در مهلت مقرر» | ☐ |
| TS-04-12 | نمایش دلیل لغو | جزئیات سفارش لغو‌شده | دلیل لغو + تاریخ لغو در صفحه نمایش داده شود | ☐ |
| TS-04-13 | چک‌اوت با پروفایل ناقص | لاگین مشتری بدون پروفایل کامل → `/checkout` | ریدایرکت به `/profile` با پیام خطا «لطفاً ابتدا پروفایل خود را تکمیل کنید» | ☐ |
| TS-04-14 | تاریخچه تغییر وضعیت سفارش | جزئیات سفارش → بخش timeline | timeline نمایش داده شود با تمام تغییرات وضعیت (ایجاد → Pending → ...) و زمان دقیق + نام کاربر تغییر‌دهنده | ☐ |
| TS-04-15 | تاریخچه تغییر وضعیت تحویل | سفارش Paid شود → ادمین وضعیت تحویل را تغییر دهد | ردیف جدیدی به timeline اضافه شود: `delivery_status: Pending → Shipped` | ☐ |
| TS-04-16 | تاریخچه لغو در timeline | سفارش لغو شود | ردیفی اضافه شود: `status: Pending → Cancelled` + `cancellation_reason: NULL → "لغو توسط مشتری"` | ☐ |

---

## 6. TS-05: پرداخت

**پیش‌نیاز**: سفارش ثبت‌شده با وضعیت Pending

| ID | اقدام | ورودی | نتیجه مورد انتظار | وضعیت |
|----|--------|-------|-------------------|--------|
| TS-05-01 | پرداخت با کیف پول (موجودی کافی) | U3 (۱۰M تومان) → «پرداخت با کیف پول» | سفارش Paid شود + موجودی کم شود + شمش Sold شود | ☐ |
| TS-05-02 | پرداخت با کیف پول (موجودی ناکافی) | U4 (بدون موجودی) → «پرداخت با کیف پول» | خطا: «موجودی کافی نیست» | ☐ |
| TS-05-03 | پرداخت با درگاه فعال (زیبال) | `active_gateway=zibal` + کلیک «پرداخت آنلاین» | ریدایرکت به درگاه زیبال (sandbox) | ☐ |
| TS-05-04 | بازگشت موفق از درگاه | پرداخت موفق در sandbox | سفارش Paid + شمش Sold + ریدایرکت به جزئیات سفارش | ☐ |
| TS-05-05 | بازگشت ناموفق از درگاه | لغو پرداخت در sandbox | سفارش Pending بماند + پیام خطا | ☐ |
| TS-05-06 | استرداد (ادمین) | ادمین → سفارش Paid → «استرداد» | مبلغ به کیف پول برگردد + شمش آزاد شود | ☐ |

---

## 7. TS-06: کیف پول

**پیش‌نیاز**: لاگین U3 (مشتری) یا D1 (نماینده)

| ID | اقدام | ورودی | نتیجه مورد انتظار | وضعیت |
|----|--------|-------|-------------------|--------|
| TS-06-01 | مشاهده داشبورد کیف پول | مرورگر → `/wallet` | موجودی، مبلغ بلوکه، موجودی قابل برداشت | ☐ |
| TS-06-02 | مشاهده تاریخچه | مرورگر → `/wallet/transactions` | لیست تراکنش‌ها با نوع، مبلغ، تاریخ | ☐ |
| TS-06-03 | شارژ کیف پول (via active gateway) | وارد کردن مبلغ + «شارژ» | ریدایرکت به درگاه فعال / تایید واریز | ☐ |
| TS-06-04 | درخواست برداشت | مبلغ: ۱,۰۰۰,۰۰۰ تومان + شبا | درخواست ایجاد شود با وضعیت PENDING | ☐ |
| TS-06-05 | تایید برداشت (ادمین) | ادمین → برداشت‌ها → «تایید» | وضعیت Paid + موجودی مشتری کم شود | ☐ |
| TS-06-06 | رد برداشت (ادمین) | ادمین → برداشت‌ها → «رد» | وضعیت Rejected + موجودی برنگردد (قبلاً بلوکه بوده) | ☐ |
| TS-06-07 | برداشت بیش از موجودی | مبلغ بیش از موجودی قابل برداشت | خطا: «موجودی کافی نیست» | ☐ |
| TS-06-08 | مشاهده صفحه خرید/فروش طلا (مشتری) | لاگین U3 → `/wallet/gold` | صفحه خرید/فروش طلا + کارمزد ۲٪ نمایش داده شود | ☐ |
| TS-06-09 | مشاهده صفحه خرید/فروش طلا (نماینده) | لاگین D1 → `/wallet/gold` | صفحه خرید/فروش طلا + کارمزد ۰.۵٪ نمایش داده شود | ☐ |
| TS-06-10 | خرید طلا با ریال | لاگین U3 → `/wallet/gold` → خرید ۱M تومان طلا | موجودی ریالی کم شود + موجودی طلایی افزایش یابد + کارمزد ۲٪ لحاظ شود | ☐ |
| TS-06-11 | فروش طلا به ریال | لاگین U3 → `/wallet/gold` → فروش ۱ گرم طلا | موجودی طلایی کم شود + موجودی ریالی افزایش یابد + کارمزد ۲٪ لحاظ شود | ☐ |
| TS-06-12 | فیلتر تراکنش بر اساس نوع دارایی | `/wallet/transactions?asset=gold` | فقط تراکنش‌های طلایی نمایش داده شود | ☐ |
| TS-06-13 | مشاهده تاریخچه برداشت‌ها | `/wallet/withdraw` | فرم درخواست برداشت + جدول درخواست‌های قبلی | ☐ |
| TS-06-14 | خرید طلا با موجودی ناکافی | خرید طلا با مبلغ بیش از موجودی ریالی | خطا: «موجودی ریالی کافی نیست» | ☐ |
| TS-06-15 | فروش طلا با موجودی ناکافی | فروش طلا با مقدار بیش از موجودی طلایی | خطا: «موجودی طلایی کافی نیست» | ☐ |
| TS-06-16 | خرید نقره با ریال | لاگین U3 → `/wallet/silver` → وارد کردن مبلغ → خرید نقره | موجودی ریالی کم شود + موجودی نقره‌ای (XAG_MG) افزایش یابد | ☐ |
| TS-06-17 | فروش نقره به ریال | لاگین U3 (با موجودی نقره) → `/wallet/silver` → فروش نقره | موجودی نقره‌ای کم شود + موجودی ریالی افزایش یابد | ☐ |
| TS-06-18 | کارمزد نقره (مشتری) | لاگین U3 → `/wallet/silver` | کارمزد ۱.۵٪ در صفحه نمایش داده شود | ☐ |
| TS-06-19 | کارمزد نقره (نماینده) | لاگین D1 → `/wallet/silver` | کارمزد ۰.۳٪ در صفحه نمایش داده شود | ☐ |
| TS-06-20 | تنظیم کارمزد نقره توسط ادمین | U1 → تنظیمات → تغییر `silver_fee_customer_percent` → ذخیره → لاگین U3 → `/wallet/silver` | کارمزد جدید در صفحه مشتری نمایش داده شود | ☐ |
| TS-06-21 | فیلتر تراکنش نقره | خرید نقره → `/wallet/transactions?asset=silver` | فقط تراکنش‌های نقره‌ای نمایش داده شود | ☐ |

---

## 8. TS-07: کوپن

| ID | اقدام | ورودی | نتیجه مورد انتظار | وضعیت |
|----|--------|-------|-------------------|--------|
| TS-07-01 | بررسی کوپن معتبر (AJAX) | `/api/coupon/check?code=WELCOME10` | JSON: valid=true + اطلاعات تخفیف | ☐ |
| TS-07-02 | بررسی کوپن نامعتبر | `/api/coupon/check?code=INVALID` | JSON: valid=false | ☐ |
| TS-07-03 | کوپن اولین خرید — مشتری جدید | U5 (بدون خرید) + WELCOME10 | تخفیف اعمال شود | ☐ |
| TS-07-04 | کوپن اولین خرید — مشتری قدیمی | U3 (با خرید قبلی) + WELCOME10 | خطا: «فقط برای اولین خرید» | ☐ |
| TS-07-05 | کوپن مبلغ ثابت — زیر حداقل | سفارش ۳M + FIXED500 (حداقل ۵M) | خطا: «حداقل مبلغ سفارش ...» | ☐ |
| TS-07-06 | کوپن مبلغ ثابت — بالای حداقل | سفارش ۶M + FIXED500 | تخفیف ۵۰۰,۰۰۰ تومان اعمال شود | ☐ |
| TS-07-07 | کوپن VIP — موبایل مجاز | موبایل در لیست سفید + VIP2026 | تخفیف ۱۵٪ اعمال شود | ☐ |
| TS-07-08 | کوپن VIP — موبایل غیرمجاز | موبایل نه در لیست سفید + VIP2026 | خطا: «مجاز نیست» | ☐ |
| TS-07-09 | کوپن منقضی | کوپن با تاریخ انقضا گذشته | خطا: «منقضی شده» | ☐ |
| TS-07-10 | کوپن با سقف استفاده پر | کوپن با max_total_uses رسیده | خطا: «ظرفیت تمام» | ☐ |

### تست‌های محدودیت دسته‌بندی (CATEGORY scope)

| ID | اقدام | ورودی | نتیجه مورد انتظار | وضعیت |
|----|--------|-------|-------------------|--------|
| TS-07-11 | ایجاد کوپن دسته‌بندی | `/admin/coupons/create` → scope: CATEGORY + انتخاب «شمش گرمی» | کوپن ایجاد شود + M2M ذخیره شود | ☐ |
| TS-07-12 | ویرایش دسته‌بندی‌های کوپن | ویرایش کوپن CATEGORY + تغییر دسته‌بندی‌های انتخابی | دسته‌بندی‌ها به‌روز شوند | ☐ |
| TS-07-13 | AJAX چک — دسته‌بندی معتبر | سبد با محصول «شمش گرمی» + کد GOLD10 (CATEGORY) | JSON: valid=true + تخفیف | ☐ |
| TS-07-14 | AJAX چک — دسته‌بندی نامعتبر | سبد با محصول از دسته‌بندی دیگر + کد GOLD10 | JSON: valid=false + خطا «فقط برای دسته‌بندی خاصی معتبر است» | ☐ |
| TS-07-15 | AJAX چک — سبد مختلط | سبد با محصول از «شمش گرمی» و دسته دیگر + GOLD10 | JSON: valid=true (اشتراک ناخالی) | ☐ |
| TS-07-16 | Checkout با کوپن CATEGORY | سبد با «شمش گرمی» + GOLD10 → ثبت سفارش | تخفیف اعمال شود + سفارش ایجاد شود | ☐ |
| TS-07-17 | کوپن GLOBAL — بدون محدودیت | سبد با هر دسته‌بندی + WELCOME10 (GLOBAL) | تخفیف اعمال شود (بدون محدودیت) | ☐ |

---

## 9. TS-08: پنل مدیریت

**پیش‌نیاز**: لاگین U1 (Super Admin)

| ID | اقدام | ورودی | نتیجه مورد انتظار | وضعیت |
|----|--------|-------|-------------------|--------|
| TS-08-01 | داشبورد | مرورگر → `/admin/dashboard` | آمار + نمودارها + سفارشات اخیر | ☐ |
| TS-08-02 | API آمار JSON | مرورگر → `/admin/dashboard/api/stats` | JSON با تمام فیلدهای stats | ☐ |
| TS-08-03 | لیست محصولات | `/admin/products` | جدول محصولات با نام، وزن، عیار، وضعیت | ☐ |
| TS-08-04 | ایجاد محصول با چند دسته‌بندی | `/admin/products/create` + فرم + انتخاب ۲ دسته‌بندی با چک‌باکس | محصول جدید ایجاد شود + هر دو دسته‌بندی ذخیره شوند (M2M) | ☐ |
| TS-08-04a | ایجاد محصول با یک دسته‌بندی | `/admin/products/create` + فرم + انتخاب ۱ دسته‌بندی | محصول ایجاد شود + فقط دسته‌بندی انتخابی ذخیره شود | ☐ |
| TS-08-05 | ویرایش محصول — تغییر دسته‌بندی‌ها | `/admin/products/{id}/edit` + تغییر چک‌باکس‌های دسته‌بندی | دسته‌بندی‌ها به‌روز شوند (قبلی‌ها حذف + جدیدها اضافه) | ☐ |
| TS-08-05a | ویرایش محصول — بررسی چک‌باکس‌های پیش‌فرض | `/admin/products/{id}/edit` | چک‌باکس‌های دسته‌بندی‌های فعلی محصول از قبل تیک خورده باشند | ☐ |
| TS-08-06 | لیست دسته‌بندی‌ها | `/admin/categories` | جدول دسته‌بندی‌ها | ☐ |
| TS-08-07 | ایجاد دسته‌بندی | `/admin/categories/create` + فرم | دسته‌بندی جدید ایجاد شود | ☐ |
| TS-08-08 | لیست شمش‌ها | `/admin/bars` | جدول شمش‌ها با فیلتر وضعیت | ☐ |
| TS-08-09 | ویرایش شمش | `/admin/bars/{id}/edit` + فرم | تخصیص محصول/نمایندگی ذخیره شود | ☐ |
| TS-08-10 | لیست سفارشات | `/admin/orders` | جدول سفارشات با فیلتر وضعیت | ☐ |
| TS-08-11 | تنظیمات سیستم | `/admin/settings` | فرم دارایی‌ها (طلا/نقره) با قیمت، آستانه انقضا، بازه بروزرسانی، سوئیچ خودکار + مالیات + ارسال | ☐ |
| TS-08-12 | تغییر قیمت طلا | تنظیمات → قیمت جدید → ذخیره | قیمت محصولات در فروشگاه تغییر کند | ☐ |
| TS-08-21 | بروزرسانی دستی قیمت (AJAX) | تنظیمات → دکمه «بروزرسانی دستی» طلا | قیمت جدید از goldis.ir دریافت و نمایش شود + نشان تازگی سبز | ☐ |
| TS-08-22 | تغییر آستانه انقضا | آستانه انقضای طلا: ۱۰ دقیقه → ذخیره | آستانه جدید ذخیره شود + بعد از ۱۰ دقیقه بدون بروزرسانی، قیمت قدیمی شمرده شود | ☐ |
| TS-08-23 | تغییر بازه بروزرسانی | بازه بروزرسانی طلا: ۲ دقیقه → ذخیره | scheduler هر ۲ دقیقه قیمت جدید بگیرد | ☐ |
| TS-08-24 | خاموش کردن بروزرسانی خودکار | سوئیچ auto_update طلا → خاموش → ذخیره | scheduler از goldis.ir نخواند + فقط بروزرسانی دستی ممکن باشد | ☐ |
| TS-08-25 | نشان تازگی قیمت | مشاهده تنظیمات بعد از بروزرسانی اخیر | نشان سبز «تازه» + زمان آخرین بروزرسانی | ☐ |
| TS-08-26 | نشان انقضای قیمت | مشاهده تنظیمات بعد از گذشت آستانه | نشان قرمز «قدیمی» | ☐ |
| TS-08-27 | هشدار قیمت قدیمی در فروشگاه | قیمت طلا قدیمی → صفحه اصلی فروشگاه | بنر زرد: «قیمت‌ها ممکن است به‌روز نباشند» نمایش شود | ☐ |
| TS-08-28 | بلاک checkout با قیمت قدیمی | قیمت طلا قدیمی → ثبت سفارش | خطا: «قیمت طلا به‌روز نیست» — سفارش ثبت نشود | ☐ |
| TS-08-29 | بلاک POS با قیمت قدیمی | قیمت طلا قدیمی → فروش حضوری | خطا: «قیمت طلا به‌روز نیست» — فروش ثبت نشود | ☐ |
| TS-08-13 | لیست حساب‌ها | `/admin/wallet/accounts` | جدول حساب‌ها با موجودی | ☐ |
| TS-08-14 | جزئیات حساب | `/admin/wallet/accounts/{id}` | تاریخچه تراکنش‌های حساب | ☐ |
| TS-08-15 | لیست برداشت‌ها | `/admin/wallet/withdrawals` | جدول درخواست‌ها با وضعیت | ☐ |
| TS-08-16 | لیست کوپن‌ها | `/admin/coupons` | جدول کوپن‌ها با وضعیت و نوع | ☐ |
| TS-08-17 | ایجاد کوپن | `/admin/coupons/create` + فرم | کوپن جدید ایجاد شود | ☐ |

### هدرهای No-Cache (جلوگیری از کش مرورگر)

| ID | اقدام | ورودی | نتیجه مورد انتظار | وضعیت |
|----|--------|-------|-------------------|--------|
| TS-08-18 | هدر No-Cache در صفحات ادمین | لاگین U1 → `/admin/dashboard` → بررسی هدرهای پاسخ (DevTools → Network) | هدرهای `Cache-Control: no-cache, no-store, must-revalidate` و `Pragma: no-cache` و `Expires: 0` وجود داشته باشند | ☐ |
| TS-08-19 | هدر No-Cache در صفحات نماینده | لاگین D1 → `/dealer/dashboard` → بررسی هدرهای پاسخ | هدرهای no-cache مشابه صفحات ادمین وجود داشته باشند | ☐ |
| TS-08-20 | عدم وجود هدر No-Cache در صفحات عمومی | مرورگر → `/` (فروشگاه) → بررسی هدرهای پاسخ | هدرهای no-cache وجود **نداشته** باشند (فقط ادمین و نماینده) | ☐ |

### سیستم دسترسی سلسله‌مراتبی اپراتور (Hierarchical Permission System)

**پیش‌نیاز**: U1 (Super Admin) برای تنظیم دسترسی‌ها، U2 (Operator) برای تست اعمال دسترسی

> سطوح دسترسی به ترتیب سلسله‌مراتبی: `none` < `view` < `create` < `edit` < `full`
> هر سطح شامل دسترسی‌های سطوح پایین‌تر هم می‌شود.

| ID | اقدام | ورودی | نتیجه مورد انتظار | وضعیت |
|----|--------|-------|-------------------|--------|
| PERM-01 | اپراتور با دسترسی view محصولات — مشاهده لیست | لاگین U2 با `operator_permissions: {"products": "view"}` → `/admin/products` | لیست محصولات نمایش داده شود ولی دکمه «افزودن محصول» وجود **نداشته** باشد | ☐ |
| PERM-02 | اپراتور با دسترسی create محصولات — دکمه افزودن | لاگین U2 با `operator_permissions: {"products": "create"}` → `/admin/products` | لیست محصولات نمایش داده شود + دکمه «افزودن محصول» قابل مشاهده و استفاده باشد | ☐ |
| PERM-03 | اپراتور با دسترسی edit محصولات — ویرایش بدون حذف | لاگین U2 با `operator_permissions: {"products": "edit"}` → `/admin/products/{id}/edit` | فرم ویرایش محصول نمایش داده شود ولی دکمه «حذف» وجود **نداشته** باشد | ☐ |
| PERM-04 | اپراتور با دسترسی full محصولات — حذف | لاگین U2 با `operator_permissions: {"products": "full"}` → `/admin/products/{id}` | دکمه «حذف» وجود داشته باشد و حذف محصول با موفقیت انجام شود | ☐ |
| PERM-05 | اپراتور با دسترسی view سفارشات — مشاهده بدون عملیات | لاگین U2 با `operator_permissions: {"orders": "view"}` → `/admin/orders` | لیست سفارشات نمایش داده شود ولی دکمه‌های «تایید»، «لغو» و «بازپرداخت» وجود **نداشته** باشند | ☐ |
| PERM-06 | اپراتور با دسترسی full سفارشات — عملیات کامل | لاگین U2 با `operator_permissions: {"orders": "full"}` → `/admin/orders/{id}` | دکمه‌های «تایید»، «لغو» و «بازپرداخت» وجود داشته باشند و هر سه عملیات با موفقیت انجام شوند | ☐ |
| PERM-07 | اپراتور بدون دسترسی wallets — خطای 403 | لاگین U2 با `operator_permissions: {}` (بدون کلید wallets) → `/admin/wallets` | خطای 403 Forbidden | ☐ |
| PERM-08 | اپراتور با دسترسی view کیف پول — مشاهده بدون تغییر | لاگین U2 با `operator_permissions: {"wallets": "view"}` → `/admin/wallets` | لیست حساب‌ها نمایش داده شود ولی امکان تنظیم/تغییر دستی موجودی وجود **نداشته** باشد | ☐ |
| PERM-09 | سوپر ادمین — عبور از همه بررسی‌های دسترسی | لاگین U1 (`admin_role="admin"`) → تمام صفحات ادمین | تمام صفحات و عملیات بدون محدودیت قابل دسترسی باشند (بدون توجه به `operator_permissions`) | ☐ |
| PERM-10 | فرم ساخت/ویرایش اپراتور — دراپ‌داون دسترسی‌ها | لاگین U1 → فرم ساخت/ویرایش اپراتور | برای هر کلید دسترسی (products, orders, wallets, …) یک دراپ‌داون با ۵ گزینه نمایش شود: none، view، create، edit، full | ☐ |
| PERM-11 | ذخیره دسترسی‌های اپراتور — فرمت dict در دیتابیس | لاگین U1 → فرم اپراتور → انتخاب دسترسی‌ها → ذخیره → بررسی DB | فیلد `operator_permissions` به فرمت dict ذخیره شود: `{"products": "edit", "orders": "view", "wallets": "full"}` | ☐ |

---

## 10. TS-09: نمایندگان

### تست‌های پنل ادمین

**پیش‌نیاز**: لاگین U1 یا U2

| ID | اقدام | ورودی | نتیجه مورد انتظار | وضعیت |
|----|--------|-------|-------------------|--------|
| TS-09-01 | لیست نمایندگان | `/admin/dealers` | جدول نمایندگان + ۶ کارت آماری | ☐ |
| TS-09-02 | ایجاد نماینده | `/admin/dealers/create` + فرم | نماینده جدید ایجاد شود | ☐ |
| TS-09-03 | ویرایش نماینده | `/admin/dealers/{id}/edit` + فرم | تغییرات ذخیره شود | ☐ |
| TS-09-04 | غیرفعال کردن نماینده | ویرایش → فعال=خاموش → ذخیره | نماینده نتواند لاگین کند | ☐ |
| TS-09-05 | لیست بازخرید | `/admin/dealers/buybacks` | جدول درخواست‌ها با فیلتر | ☐ |
| TS-09-06 | فیلتر بازخرید | فیلتر «در انتظار» | فقط درخواست‌های Pending | ☐ |
| TS-09-07 | تایید بازخرید | درخواست Pending → «تایید» + یادداشت | وضعیت به Approved تغییر کند | ☐ |
| TS-09-08 | رد بازخرید | درخواست Pending → «رد» + دلیل | وضعیت به Rejected + دلیل رد نمایش شود | ☐ |
| TS-09-09 | API آمار نمایندگان | `/admin/dealers/stats` | JSON با total_dealers, total_sales, ... | ☐ |

### گزارش فروش POS (ادمین)

**پیش‌نیاز**: لاگین U1 یا U2 (با دسترسی `dealers`)

| ID | اقدام | ورودی | نتیجه مورد انتظار | وضعیت |
|----|--------|-------|-------------------|--------|
| TS-09-20 | مشاهده صفحه گزارش فروش POS | `/admin/dealers/sales` | صفحه با جدول تمام فروش‌های POS + کارت‌های آماری (تعداد فروش، مبلغ کل، سود کل، ...) نمایش شود | ☐ |
| TS-09-21 | فیلتر بر اساس نماینده | انتخاب نماینده D1 از فیلتر | فقط فروش‌های نماینده D1 نمایش شوند + آمار بالای صفحه فقط مربوط به D1 به‌روز شود | ☐ |
| TS-09-22 | جستجو با سریال‌کد شمش | وارد کردن سریال‌کد یکی از شمش‌های فروخته‌شده در فیلد جستجو | فروش مربوط به آن سریال‌کد در نتایج نمایش شود | ☐ |
| TS-09-23 | جستجو با موبایل مشتری | وارد کردن شماره موبایل خریدار (مثلاً `09351234567`) در فیلد جستجو | فروش‌هایی که موبایل خریدار مطابقت دارد نمایش شوند | ☐ |
| TS-09-24 | فیلتر بر اساس بازه تاریخی | تنظیم تاریخ شروع و پایان در فیلتر تاریخ | فقط فروش‌های ثبت‌شده در بازه مشخص‌شده نمایش شوند | ☐ |
| TS-09-25 | فیلتر بر اساس تخفیف (بله) | انتخاب فیلتر تخفیف: «دارد» | فقط فروش‌هایی که تخفیف اجرت دارند (discount_wage_percent > 0) نمایش شوند | ☐ |
| TS-09-26 | فیلتر بر اساس تخفیف (خیر) | انتخاب فیلتر تخفیف: «ندارد» | فقط فروش‌هایی که بدون تخفیف اجرت هستند نمایش شوند | ☐ |
| TS-09-27 | پاک کردن تمام فیلترها | کلیک روی دکمه «پاک کردن فیلترها» | تمام فیلترها ریست شوند + لیست کامل فروش‌ها بازگردد + آمار کلی نمایش شود | ☐ |
| TS-09-28 | صفحه‌بندی (Pagination) | اگر بیش از ۳۰ فروش وجود داشته باشد → کلیک روی صفحه ۲ | ۳۰ آیتم در هر صفحه + ناوبری صفحه‌بندی صحیح کار کند + فیلترها در تغییر صفحه حفظ شوند | ☐ |
| TS-09-29 | دسترسی بدون مجوز `dealers` | لاگین اپراتور بدون دسترسی `dealers` → `/admin/dealers/sales` | خطای ۴۰۳ یا ریدایرکت به صفحه اصلی ادمین با پیام «دسترسی ندارید» | ☐ |

### تست‌های پنل نماینده

**پیش‌نیاز**: لاگین نماینده D1

| ID | اقدام | ورودی | نتیجه مورد انتظار | وضعیت |
|----|--------|-------|-------------------|--------|
| TS-09-10 | داشبورد نماینده | `/dealer/dashboard` | آمار فروش + کمیسیون + اقدامات سریع | ☐ |
| TS-09-11 | فروش حضوری (POS) — فرم | `/dealer/pos` | فرم با فیلد شمش، قیمت، اطلاعات خریدار + اطلاعات سهم اجرت | ☐ |
| TS-09-12 | فروش حضوری — ثبت بدون تخفیف | انتخاب شمش + مبلغ سیستمی + نام خریدار | فروش ثبت شود + سود طلایی کامل | ☐ |
| TS-09-12a | فروش حضوری — ثبت با تخفیف | انتخاب شمش + تنظیم تخفیف ۵۰٪ سهم + نام خریدار | فروش ثبت شود + سود طلایی نصف شده + ستون تخفیف در تاریخچه | ☐ |
| TS-09-12b | فروش حضوری — تخفیف بیش از سهم | تنظیم تخفیف بیش از margin% | خطا: «حداکثر تخفیف مجاز X% اجرت است» | ☐ |
| TS-09-12c | فروش حضوری — نمایش سهم اجرت | انتخاب شمش در POS | نمایش ec_wage%, dealer_wage%, margin% + اسلایدر تخفیف | ☐ |
| TS-09-13 | فروش — شمش نامعتبر | سریال‌کد اشتباه | خطا: «شمش یافت نشد» | ☐ |
| TS-09-14 | بازخرید — فرم | `/dealer/buyback` | فرم با فیلد سریال، مبلغ، اطلاعات فروشنده | ☐ |
| TS-09-15 | بازخرید — ثبت | سریال شمش فروخته‌شده + مبلغ ۴.۵M تومان | درخواست بازخرید ثبت شود با وضعیت Pending | ☐ |
| TS-09-16 | تاریخچه فروش | `/dealer/sales` | لیست فروش‌ها با مبلغ، سود طلایی، تخفیف اجرت، تاریخ | ☐ |
| TS-09-17 | تاریخچه بازخرید | `/dealer/buybacks` | لیست درخواست‌ها با وضعیت و رنگ badge | ☐ |

---

## 11. TS-10: احراز اصالت

| ID | اقدام | ورودی | نتیجه مورد انتظار | وضعیت |
|----|--------|-------|-------------------|--------|
| TS-10-01 | صفحه احراز اصالت | مرورگر → `/verify` | فرم ورود سریال‌کد | ☐ |
| TS-10-02 | سریال‌کد معتبر | سریال‌کد یکی از شمش‌های seed | نمایش: محصول، وزن، عیار، وضعیت | ☐ |
| TS-10-03 | سریال‌کد نامعتبر | سریال‌کد: `XXXXXXXX` | پیام «سریال‌کد یافت نشد» | ☐ |
| TS-10-04 | بدون لاگین | بدون هیچ کوکی auth → `/verify` | صفحه باید بدون مشکل باز شود (عمومی) | ☐ |

---

## 12. TS-11: پروفایل و آدرس

**پیش‌نیاز**: لاگین U3

| ID | اقدام | ورودی | نتیجه مورد انتظار | وضعیت |
|----|--------|-------|-------------------|--------|
| TS-11-01 | مشاهده پروفایل | مرورگر → `/profile` | نمایش نام، موبایل، کد ملی | ☐ |
| TS-11-02 | ویرایش پروفایل | نام جدید → «ذخیره» | نام به‌روز شود | ☐ |
| TS-11-03 | مشاهده دفتر آدرس | مرورگر → `/addresses` | لیست آدرس‌ها | ☐ |
| TS-11-04 | تکمیل پروفایل الزامی برای خرید | لاگین مشتری بدون پروفایل کامل → `/checkout` یا POST `/cart/checkout` | ریدایرکت به `/profile` با پیام خطا؛ سفارش ثبت نشود | ☐ |
| TS-11-05 | ذخیره پروفایل حقوقی | نوع مشتری: حقوقی → نام شرکت: «شرکت زرین تجارت» + کد اقتصادی → «ذخیره» | نوع حقوقی + نام شرکت + کد اقتصادی ذخیره شوند + پروفایل کامل شود | ☐ |
| TS-11-06 | ذخیره پروفایل حقیقی | نوع مشتری: حقیقی → کدپستی: 1234567890 + آدرس: تهران → «ذخیره» | نوع حقیقی + کدپستی + آدرس ذخیره شوند + پروفایل کامل شود | ☐ |
| TS-11-07 | نمایش اطلاعات صورتحساب در سفارش | ثبت سفارش + مشاهده `/orders/{id}` | بخش اطلاعات صورتحساب نمایش شود: نوع مشتری، نام/شرکت، کد ملی، موبایل، تلفن، کدپستی، آدرس | ☐ |
| TS-11-08 | افزودن آدرس | فرم: عنوان + استان + شهر + آدرس + کدپستی | آدرس جدید اضافه شود | ☐ |
| TS-11-09 | حذف آدرس | کلیک «حذف» روی آدرس | آدرس حذف شود | ☐ |
| TS-11-10 | تعیین آدرس پیش‌فرض | کلیک «پیش‌فرض» | آدرس انتخابی پیش‌فرض شود | ☐ |
| TS-11-11 | AJAX شهرها | انتخاب استان در فرم آدرس | شهرهای آن استان بارگذاری شوند | ☐ |
| TS-11-12 | AJAX مناطق | انتخاب شهر | مناطق آن شهر بارگذاری شوند | ☐ |

---

## 13. TS-12: تیکتینگ / پشتیبانی

### تیکت مشتری

| شناسه | اقدام | ورودی / مراحل | نتیجه مورد انتظار | وضعیت |
|--------|--------|---------------|---------------------|--------|
| TS-12-01 | مشاهده لیست تیکت‌ها (مشتری) | لاگین U3 → `/tickets` | صفحه لیست تیکت‌ها نمایش داده شود (با تیکت‌های seed) | ☐ |
| TS-12-02 | ایجاد تیکت جدید (مشتری) | `/tickets/new` → موضوع: «مشکل ارسال» + اولویت: متوسط + متن | ثبت موفق + ریدایرکت به جزئیات تیکت | ☐ |
| TS-12-03 | مشاهده جزئیات تیکت | `/tickets/{id}` | پیام اولیه + اطلاعات تیکت نمایش داده شود | ☐ |
| TS-12-04 | ارسال پاسخ (مشتری) | در جزئیات تیکت → فرم پاسخ → «ارسال» | پیام جدید اضافه شود | ☐ |
| TS-12-05 | بستن تیکت (مشتری) | در جزئیات → «بستن تیکت» | وضعیت → Closed + فرم پاسخ مخفی | ☐ |
| TS-12-06 | عدم دسترسی به تیکت دیگران | لاگین U4 → `/tickets/1` (تیکت U3) | خطای 403 | ☐ |

### تیکت نماینده

| شناسه | اقدام | ورودی / مراحل | نتیجه مورد انتظار | وضعیت |
|--------|--------|---------------|---------------------|--------|
| TS-12-07 | مشاهده لیست تیکت‌ها (نماینده) | لاگین D1 → `/tickets` | صفحه لیست تیکت‌های نماینده | ☐ |
| TS-12-08 | ایجاد تیکت (نماینده) | `/tickets/new` → موضوع + متن | ثبت موفق + ریدایرکت به جزئیات | ☐ |
| TS-12-09 | ارسال پاسخ (نماینده) | جزئیات تیکت → ارسال پاسخ | پیام اضافه شود | ☐ |
| TS-12-10 | عدم دسترسی به تیکت نماینده دیگر | لاگین D2 → `/tickets/3` (تیکت D1) | خطای 403 | ☐ |

### مدیریت تیکت (ادمین)

| شناسه | اقدام | ورودی / مراحل | نتیجه مورد انتظار | وضعیت |
|--------|--------|---------------|---------------------|--------|
| TS-12-11 | لیست تیکت‌ها — تب همه | لاگین U1 → `/admin/tickets` | تمام تیکت‌ها + badge تعداد | ☐ |
| TS-12-12 | لیست تیکت‌ها — تب مشتریان | `/admin/tickets?sender_type=CUSTOMER` | فقط تیکت‌های مشتریان + badge آبی | ☐ |
| TS-12-13 | لیست تیکت‌ها — تب نمایندگان | `/admin/tickets?sender_type=DEALER` | فقط تیکت‌های نمایندگان + badge بنفش | ☐ |
| TS-12-14 | فیلتر وضعیت | `/admin/tickets?status=Open` | فقط تیکت‌های باز | ☐ |
| TS-12-15 | جزئیات تیکت (ادمین) | `/admin/tickets/1` | مکالمه + پنل کناری (فرستنده، وضعیت، تخصیص) | ☐ |
| TS-12-16 | پاسخ ادمین | جزئیات → فرم پاسخ → «ارسال» | پیام اضافه + وضعیت → Answered + تخصیص خودکار | ☐ |
| TS-12-17 | تخصیص به اپراتور | پنل کناری → انتخاب اپراتور → «تخصیص» | تخصیص موفق + وضعیت Open → InProgress | ☐ |
| TS-12-18 | تغییر وضعیت | پنل کناری → وضعیت جدید → «اعمال» | وضعیت تغییر کند | ☐ |
| TS-12-19 | بستن تیکت (ادمین) | پنل کناری → «بستن تیکت» | وضعیت → Closed | ☐ |
| TS-12-20 | بازگشایی خودکار | ادمین پاسخ داده (Answered) → مشتری پاسخ می‌دهد | وضعیت → Open (بازشده) | ☐ |

### پیوست فایل (File Attachment)

| شناسه | اقدام | ورودی / مراحل | نتیجه مورد انتظار | وضعیت |
|--------|--------|---------------|---------------------|--------|
| TC-TKT-ATT-01 | ایجاد تیکت با پیوست فایل | لاگین U3 → `/tickets/new` → موضوع + متن + انتخاب فایل تصویری → «ارسال» | فایل آپلود شود + در جزئیات تیکت به‌صورت تصویر بندانگشتی (thumbnail) نمایش داده شود | ☐ |
| TC-TKT-ATT-02 | پاسخ به تیکت با پیوست فایل | جزئیات تیکت → فرم پاسخ → متن + انتخاب فایل → «ارسال» | پیوست در نخ مکالمه (conversation thread) نمایش داده شود | ☐ |
| TC-TKT-ATT-03 | پاسخ ادمین با پیوست فایل | لاگین U1 → `/admin/tickets/{id}` → فرم پاسخ → متن + فایل → «ارسال» | مشتری/نماینده در جزئیات تیکت خود پیوست ادمین را ببیند | ☐ |

### دسته‌بندی تیکت (Ticket Category)

| شناسه | اقدام | ورودی / مراحل | نتیجه مورد انتظار | وضعیت |
|--------|--------|---------------|---------------------|--------|
| TC-TKT-CAT-01 | ایجاد تیکت با انتخاب دسته‌بندی | لاگین U3 → `/tickets/new` → انتخاب دسته‌بندی از dropdown + موضوع + متن → «ارسال» | badge دسته‌بندی در جزئیات تیکت و لیست تیکت‌های ادمین نمایش داده شود | ☐ |
| TC-TKT-CAT-02 | فیلتر تیکت‌ها بر اساس دسته‌بندی (ادمین) | لاگین U1 → `/admin/tickets` → انتخاب دسته‌بندی از فیلتر | فقط تیکت‌های دسته‌بندی انتخاب‌شده نمایش داده شوند | ☐ |

### یادداشت داخلی (Internal Note)

| شناسه | اقدام | ورودی / مراحل | نتیجه مورد انتظار | وضعیت |
|--------|--------|---------------|---------------------|--------|
| TC-TKT-INT-01 | ثبت یادداشت داخلی توسط ادمین | لاگین U1 → `/admin/tickets/{id}` → فرم یادداشت داخلی → متن → «ارسال» | یادداشت در جزئیات ادمین با آیکون قفل و استایل هشدار (warning) نمایش داده شود | ☐ |
| TC-TKT-INT-02 | عدم نمایش یادداشت داخلی به مشتری | لاگین U3 → `/tickets/{id}` (تیکتی که ادمین یادداشت داخلی ثبت کرده) | یادداشت داخلی به مشتری نمایش داده نشود | ☐ |
| TC-TKT-INT-03 | عدم نمایش یادداشت داخلی به نماینده | لاگین D1 → `/tickets/{id}` (تیکتی که ادمین یادداشت داخلی ثبت کرده) | یادداشت داخلی به نماینده نمایش داده نشود | ☐ |

### جستجوی تیکت (Ticket Search)

| شناسه | اقدام | ورودی / مراحل | نتیجه مورد انتظار | وضعیت |
|--------|--------|---------------|---------------------|--------|
| TC-TKT-SRCH-01 | جستجو بر اساس شناسه تیکت | لاگین U1 → `/admin/tickets` → فیلد جستجو → وارد کردن شماره تیکت | تیکت مورد نظر پیدا و نمایش داده شود | ☐ |
| TC-TKT-SRCH-02 | جستجو بر اساس موبایل مشتری | لاگین U1 → `/admin/tickets` → فیلد جستجو → وارد کردن شماره موبایل مشتری | تیکت‌های مطابق نمایش داده شوند | ☐ |
| TC-TKT-SRCH-03 | جستجو بر اساس کلمه کلیدی موضوع | لاگین U1 → `/admin/tickets` → فیلد جستجو → وارد کردن کلمه‌ای از موضوع تیکت | تیکت‌های مطابق نمایش داده شوند | ☐ |

### اعلان‌ها (Notifications — حالت توسعه)

| شناسه | اقدام | ورودی / مراحل | نتیجه مورد انتظار | وضعیت |
|--------|--------|---------------|---------------------|--------|
| TC-TKT-NOTIF-01 | اعلان پاسخ ادمین | لاگین U1 → `/admin/tickets/{id}` → ارسال پاسخ | خروجی debug اعلان در کنسول سرور نمایش داده شود (حالت dev) | ☐ |
| TC-TKT-NOTIF-02 | اعلان تغییر وضعیت تیکت | لاگین U1 → `/admin/tickets/{id}` → تغییر وضعیت | خروجی debug اعلان تغییر وضعیت در کنسول سرور نمایش داده شود | ☐ |

---

## 14. TS-13: POS REST API نماینده

### احراز هویت API Key

| # | شرح تست | پیش‌شرط | اقدام | نتیجه مورد انتظار |
|---|---------|---------|-------|-------------------|
| TS-13-01 | درخواست بدون هدر X-API-Key | — | GET /api/dealer/info | خطا 422 |
| TS-13-02 | درخواست با کلید نامعتبر | — | GET /api/dealer/info با کلید اشتباه | خطا 401 |
| TS-13-03 | درخواست با کلید معتبر | نماینده فعال با API Key | GET /api/dealer/info | 200 + اطلاعات نماینده |
| TS-13-04 | نماینده غیرفعال با کلید معتبر | نماینده غیرفعال | GET /api/dealer/info | خطا 401 |

### لیست محصولات

| # | شرح تست | پیش‌شرط | اقدام | نتیجه مورد انتظار |
|---|---------|---------|-------|-------------------|
| TS-13-05 | دریافت لیست محصولات | نماینده با شمش‌های فعال | GET /api/dealer/products | 200 + لیست محصولات با قیمت و سریال + فیلد `categories` آرایه‌ای از نام دسته‌بندی‌ها (نه رشته تکی) |
| TS-13-06 | قیمت‌گذاری لحظه‌ای | تغییر قیمت طلا در تنظیمات | GET /api/dealer/products | قیمت‌ها بروزرسانی شده |
| TS-13-07 | شعبه بدون شمش | نماینده بدون شمش ASSIGNED | GET /api/dealer/products | 200 + لیست خالی |

### ثبت فروش POS

| # | شرح تست | پیش‌شرط | اقدام | نتیجه مورد انتظار |
|---|---------|---------|-------|-------------------|
| TS-13-08 | فروش موفق بدون تخفیف | سریال شمش موجود و ASSIGNED | POST /api/dealer/sale (بدون discount_wage_percent) | 200 + sale_id + gold_profit_mg کامل + discount_wage_percent=0 |
| TS-13-08a | فروش موفق با تخفیف | شمش ASSIGNED + discount_wage_percent=14 | POST /api/dealer/sale | 200 + gold_profit_mg کاهش‌یافته + discount_wage_percent=14 |
| TS-13-08b | فروش — تخفیف بیش از سهم | discount_wage_percent > margin | POST /api/dealer/sale | خطا 400: «حداکثر تخفیف مجاز» |
| TS-13-08c | فروش — قیمت نامطابق با تخفیف | sale_price نامطابق با اجرت مؤثر | POST /api/dealer/sale | خطا 400: «مبلغ فروش مطابقت ندارد» |
| TS-13-08d | محصولات با اطلاعات سهم | نماینده فعال | GET /api/dealer/products | هر محصول شامل ec_wage_pct, dealer_wage_pct, margin_pct |
| TS-13-09 | فروش شمش فروخته‌شده | شمش با وضعیت SOLD | POST /api/dealer/sale | خطا 400 |
| TS-13-10 | سریال نامعتبر | سریال وجود ندارد | POST /api/dealer/sale | خطا 400 |
| TS-13-11 | شمش شعبه دیگر | شمش در شعبه دیگر | POST /api/dealer/sale | خطا 400 |
| TS-13-12 | بروزرسانی موجودی بعد از فروش | فروش موفق | GET /api/dealer/products | stock_count کاهش یافته |
| TS-13-13 | ارتباط با مشتری موجود | موبایل مشتری ثبت‌شده | POST /api/dealer/sale | شمش به مشتری لینک شده |

### تاریخچه فروش

| # | شرح تست | پیش‌شرط | اقدام | نتیجه مورد انتظار |
|---|---------|---------|-------|-------------------|
| TS-13-14 | لیست فروش‌ها | فروش‌های ثبت‌شده | GET /api/dealer/sales | 200 + لیست فروش‌ها |
| TS-13-15 | صفحه‌بندی | بیش از ۲۰ فروش | GET /api/dealer/sales?page=2 | صفحه دوم |

### مدیریت کلید API (ادمین)

| # | شرح تست | پیش‌شرط | اقدام | نتیجه مورد انتظار |
|---|---------|---------|-------|-------------------|
| TS-13-16 | تولید کلید API | نماینده بدون کلید | POST generate-api-key | کلید ۶۴ کاراکتری در فرم |
| TS-13-17 | تولید مجدد کلید | نماینده با کلید قبلی | POST generate-api-key | کلید قبلی باطل + کلید جدید |
| TS-13-18 | لغو کلید API | نماینده با کلید فعال | POST revoke-api-key | کلید حذف شده + دستگاه 401 |

---

## 15. TS-14: بازپرداخت اجرت بازخرید

**پیش‌نیاز**: لاگین U1 (Super Admin) + حداقل یک BuybackRequest با وضعیت Pending + مشتری با کیف پول (U3)

### تایید بازخرید و اعتبار اجرت

| ID | اقدام | ورودی | نتیجه مورد انتظار | وضعیت |
|----|--------|-------|-------------------|--------|
| TC-BBWR-01 | تایید بازخرید شمش فروش آنلاین → واریز اعتبار اجرت | `/admin/dealers/buybacks` → کلیک «تایید» روی بازخرید Pending (شمش فروخته‌شده از فروشگاه آنلاین) | وضعیت شمش → ASSIGNED + اعتبار اجرت (wage_amount از OrderItem.final_wage_amount) به credit_balance مشتری واریز شود + پیام موفقیت شامل مبلغ اعتبار اجرت + BuybackRequest.wage_refund_amount مقداردهی شود + ستون «اعتبار اجرت» در جدول بازخرید مبلغ را نمایش دهد | ☐ |
| TC-BBWR-02 | تایید بازخرید شمش فروش حضوری (POS) → بدون واریز اعتبار | `/admin/dealers/buybacks` → کلیک «تایید» روی بازخرید Pending (شمش فروخته‌شده از POS، بدون OrderItem) | وضعیت شمش → ASSIGNED + هیچ واریزی به کیف پول انجام نشود + پیام موفقیت: «بازخرید #X تایید شد» بدون اشاره به اعتبار اجرت + BuybackRequest.wage_refund_amount برابر ۰ بماند | ☐ |

### اعتبار فروشگاهی در کیف پول مشتری

| ID | اقدام | ورودی | نتیجه مورد انتظار | وضعیت |
|----|--------|-------|-------------------|--------|
| TC-BBWR-03 | نمایش اعتبار فروشگاهی در کیف پول | لاگین مشتری (U3) → `/wallet` (پس از تایید بازخرید با واریز اجرت) | بخش «اعتبار فروشگاهی» نمایش داده شود با مبلغ واریزشده + «قابل برداشت» فقط موجودی قابل برداشت (بدون اعتبار) را نشان دهد + پیام راهنما درباره غیرقابل‌برداشت بودن اعتبار نمایش شود | ☐ |
| TC-BBWR-04 | عدم امکان برداشت اعتبار فروشگاهی | `/wallet/withdraw` → وارد کردن مبلغی بیش از موجودی قابل برداشت (شامل اعتبار) | خطا: «موجودی قابل برداشت کافی نیست» + فرم حداکثر مبلغ برداشت را بر اساس موجودی قابل برداشت (نه موجودی کل) نمایش دهد | ☐ |

### مصرف اعتبار در خرید

| ID | اقدام | ورودی | نتیجه مورد انتظار | وضعیت |
|----|--------|-------|-------------------|--------|
| TC-BBWR-05 | پرداخت سفارش با استفاده از اعتبار فروشگاهی | مشتری با اعتبار فروشگاهی → افزودن محصول به سبد → checkout → «پرداخت با کیف پول» | پرداخت موفق با استفاده از موجودی کل (شامل اعتبار) + اگر موجودی عادی کمتر از مبلغ سفارش باشد، اعتبار برای مابقی مصرف شود + پس از پرداخت، credit_balance به‌میزان مصرف‌شده کاهش یابد | ☐ |

### نمایش اعتبار در پنل ادمین

| ID | اقدام | ورودی | نتیجه مورد انتظار | وضعیت |
|----|--------|-------|-------------------|--------|
| TC-BBWR-06 | مشاهده اعتبار فروشگاهی در جزئیات کیف پول (ادمین) | لاگین U1 → `/admin/wallets/{user_id}` | خلاصه موجودی شامل «اعتبار فروشگاهی» با مبلغ + «قابل برداشت» با موجودی قابل برداشت + تراکنش CREDIT در لیست با توضیحات شامل سریال شمش | ☐ |

---

## 16. TS-15: صفحات ثابت و فوتر

### صفحات ثابت (Static Pages)

| ID | اقدام | ورودی | نتیجه مورد انتظار | وضعیت |
|----|--------|-------|-------------------|--------|
| TS-15-01 | باز کردن صفحه درباره ما | مرورگر → `/about` (بدون لاگین) | صفحه درباره ما با اطلاعات شرکت نمایش داده شود + ناوبار و فوتر کامل | ☐ |
| TS-15-02 | باز کردن صفحه سوالات متداول | مرورگر → `/faq` (بدون لاگین) | صفحه FAQ با سوالات و پاسخ‌ها (Accordion) نمایش داده شود | ☐ |
| TS-15-03 | باز کردن صفحه تماس با ما | مرورگر → `/contact` (بدون لاگین) | صفحه تماس با آدرس، تلفن، ایمیل و ساعت کاری نمایش داده شود | ☐ |
| TS-15-04 | باز کردن صفحه قوانین و مقررات | مرورگر → `/terms` (بدون لاگین) | صفحه قوانین و مقررات نمایش داده شود | ☐ |
| TS-15-05 | دسترسی با لاگین مشتری | لاگین U3 → `/about` | صفحه درباره ما نمایش شود + ناوبار شامل نام کاربر و سبد خرید باشد | ☐ |
| TS-15-06 | دسترسی با لاگین ادمین | لاگین U1 → `/faq` | صفحه سوالات متداول نمایش شود | ☐ |

### صفحه ۴۰۴ سفارشی

| ID | اقدام | ورودی | نتیجه مورد انتظار | وضعیت |
|----|--------|-------|-------------------|--------|
| TS-15-07 | آدرس ناموجود (بدون لاگین) | مرورگر → `/nonexistent-page` | صفحه ۴۰۴ سفارشی با پیام فارسی «صفحه یافت نشد» + دکمه بازگشت + طراحی مطابق سایت | ☐ |
| TS-15-08 | آدرس ناموجود (با لاگین) | لاگین U3 → `/some-invalid-url` | صفحه ۴۰۴ سفارشی نمایش شود + ناوبار شامل اطلاعات کاربر | ☐ |

### فوتر (Footer)

| ID | اقدام | ورودی | نتیجه مورد انتظار | وضعیت |
|----|--------|-------|-------------------|--------|
| TS-15-09 | نمایش فوتر در صفحه اصلی | مرورگر → `/` | فوتر با اطلاعات شرکت، لینک‌های سریع، نشان‌های اعتماد و شبکه‌های اجتماعی نمایش شود | ☐ |
| TS-15-10 | لینک‌های فوتر | کلیک روی لینک‌های فوتر (درباره ما، سوالات متداول، تماس، قوانین) | هر لینک به صفحه صحیح هدایت شود | ☐ |
| TS-15-11 | فوتر در صفحات ثابت | مرورگر → `/about` → اسکرول به پایین | فوتر کامل نمایش داده شود | ☐ |

### ناوبار (Navbar)

| ID | اقدام | ورودی | نتیجه مورد انتظار | وضعیت |
|----|--------|-------|-------------------|--------|
| TS-15-12 | لینک‌های ناوبار — احراز اصالت | کلیک روی لینک «احراز اصالت» در ناوبار | ریدایرکت به `/verify` | ☐ |
| TS-15-13 | لینک‌های ناوبار — سوالات متداول | کلیک روی لینک «سوالات متداول» در ناوبار | ریدایرکت به `/faq` | ☐ |
| TS-15-14 | لینک‌های ناوبار — درباره ما | کلیک روی لینک «درباره ما» در ناوبار | ریدایرکت به `/about` | ☐ |
| TS-15-15 | لینک‌های ناوبار — تماس با ما | کلیک روی لینک «تماس با ما» در ناوبار | ریدایرکت به `/contact` | ☐ |

---

## 17. TS-16: ثبت مالکیت، خرید هدیه و انتقال شمش

### فروش POS با کد ثبت مالکیت (Claim Code)

**پیش‌نیاز**: لاگین نماینده D1 + شمش‌های ASSIGNED در شعبه نماینده

| ID | اقدام | ورودی | نتیجه مورد انتظار | وضعیت |
|----|--------|-------|-------------------|--------|
| TS-16-01 | فروش POS — تولید claim_code (وب) | `/dealer/pos` → انتخاب شمش + مبلغ + اطلاعات خریدار → «ثبت فروش» | فروش ثبت شود + claim_code ۶ کاراکتری در رسید نمایش داده شود | ☐ |
| TS-16-02 | فروش POS — تولید claim_code (API) | `POST /api/dealer/sale` با اطلاعات معتبر | پاسخ JSON شامل `claim_code` باشد (۶ کاراکتر از مجموعه ABCDEFGHJKMNPQRSTUVWXYZ23456789) | ☐ |
| TS-16-03 | فروش POS — شمش بعد از فروش | بررسی شمش فروخته‌شده در `/admin/bars` | وضعیت SOLD + user_id خالی (NULL) + claim_code مقداردهی شده | ☐ |

### خرید هدیه (Gift Purchase)

**پیش‌نیاز**: لاگین U3 + حداقل ۱ آیتم در سبد

| ID | اقدام | ورودی | نتیجه مورد انتظار | وضعیت |
|----|--------|-------|-------------------|--------|
| TS-16-04 | چک‌اوت با گزینه هدیه | `/checkout` → تیک «خرید به‌عنوان هدیه» + انتخاب روش تحویل → «ثبت سفارش» | سفارش ایجاد شود با is_gift=True | ☐ |
| TS-16-05 | پرداخت سفارش هدیه | سفارش هدیه → «پرداخت با کیف پول» | پرداخت موفق + شمش وضعیت SOLD + user_id خالی (NULL) + claim_code تولید شود | ☐ |
| TS-16-06 | نمایش claim_code پس از پرداخت هدیه | جزئیات سفارش هدیه پس از پرداخت | claim_code در صفحه جزئیات سفارش نمایش داده شود | ☐ |
| TS-16-07 | سفارش عادی (بدون هدیه) | `/checkout` → بدون تیک هدیه → ثبت و پرداخت | سفارش عادی + شمش با user_id مشتری + بدون claim_code | ☐ |

### ثبت مالکیت (Claim Bar)

**داده تستی آماده (از seed):**
- شمش `TSCLM001` → کد ثبت مالکیت: `ABC123` (بدون مالک، آماده ادعا)
- شمش `TSCLM002` → کد ثبت مالکیت: `XYZ789` (بدون مالک، برای تست کد اشتباه)
- شمش `TSTRF001` → متعلق به U3 (09351234567) (بدون claim_code، برای تست انتقال)

**برای مشاهده اطلاعات شمش از پنل ادمین:**
لاگین ادمین (09123456789) → پنل مدیریت → شمش‌ها → جستجوی سریال `TSCLM001` → زیر سریال‌کد، «کد ثبت مالکیت» نمایش داده می‌شود.
همچنین با کلیک روی دکمه ویرایش شمش، در بخش «اطلاعات سریع» کد ثبت مالکیت قابل مشاهده است.

| ID | اقدام | گام‌به‌گام | نتیجه مورد انتظار | وضعیت |
|----|--------|-----------|-------------------|--------|
| TS-16-08 | باز کردن صفحه ثبت مالکیت از منو | ۱. با موبایل `09359876543` (U4) لاگین کنید ۲. روی نام کاربر (بالا-چپ) کلیک کنید تا منوی کشویی باز شود ۳. گزینه **«ثبت شمش»** را بزنید | فرم ثبت مالکیت با دو فیلد «سریال‌کد» و «کد ثبت مالکیت» نمایش شود | ☐ |
| TS-16-09 | ثبت مالکیت موفق | ۱. در فرم ثبت مالکیت (مرحله قبل): ۲. فیلد سریال‌کد: `TSCLM001` ۳. فیلد کد ثبت مالکیت: `ABC123` ۴. دکمه «ثبت مالکیت» را بزنید | پیام موفقیت نمایش شود + شمش به نام U4 ثبت شود | ☐ |
| TS-16-10 | بررسی ثبت از پنل ادمین | ۱. لاگین ادمین (09123456789) → پنل مدیریت → شمش‌ها ۲. شمش `TSCLM001` را پیدا کنید | ستون مالک: نام U4 نمایش شود + کد ثبت مالکیت دیگر نمایش داده نشود (حذف شده) | ☐ |
| TS-16-11 | ثبت مالکیت — کد اشتباه | ۱. لاگین U4 → منوی کشویی → «ثبت شمش» ۲. سریال‌کد: `TSCLM002` ۳. کد ثبت مالکیت: `WRONG1` (اشتباه — کد درست: XYZ789) ۴. دکمه «ثبت مالکیت» | پیام خطا: کد ثبت مالکیت نامعتبر است | ☐ |
| TS-16-12 | ثبت مالکیت — سریال‌کد ناموجود | ۱. لاگین U4 → منوی کشویی → «ثبت شمش» ۲. سریال‌کد: `XXXXXXXX` (ناموجود) ۳. کد ثبت مالکیت: `ABC123` ۴. دکمه «ثبت مالکیت» | پیام خطا: شمش یافت نشد | ☐ |
| TS-16-13 | ثبت مالکیت — شمش با مالک قبلی | ۱. لاگین U4 → منوی کشویی → «ثبت شمش» ۲. سریال‌کد: `TSCLM001` (شمشی که قبلاً ثبت شد) ۳. هر کد ثبت مالکیت ۴. دکمه «ثبت مالکیت» | پیام خطا: این شمش قبلاً ثبت مالکیت شده است | ☐ |

### مشاهده شمش‌های من (My Bars)

**پیش‌نیاز**: تست TS-16-09 با موفقیت انجام شده باشد (شمش TSCLM001 به نام U4 ثبت شده)

| ID | اقدام | گام‌به‌گام | نتیجه مورد انتظار | وضعیت |
|----|--------|-----------|-------------------|--------|
| TS-16-14 | مشاهده شمش ثبت‌شده | ۱. لاگین U4 (09359876543) ۲. منوی کشویی → «شمش‌های من» | شمش `TSCLM001` در لیست با سریال‌کد، نام محصول، وزن و عیار نمایش شود | ☐ |
| TS-16-15 | شمش‌های مشتری U3 | ۱. لاگین U3 (09351234567) ۲. منوی کشویی → «شمش‌های من» | شمش `TSTRF001` در لیست نمایش شود (از seed data) | ☐ |
| TS-16-16 | مشتری بدون شمش | ۱. لاگین U5 (09131112233) ۲. منوی کشویی → «شمش‌های من» | پیام «هنوز شمشی به نام شما ثبت نشده» + دکمه «ثبت شمش با کد» | ☐ |
| TS-16-17 | دکمه‌های عملیات | ۱. لاگین U3 → منوی کشویی → «شمش‌های من» ۲. کنار شمش `TSTRF001` نگاه کنید | دو دکمه «اصالت‌سنجی» و «انتقال» نمایش شود | ☐ |

### انتقال مالکیت (Ownership Transfer)

**پیش‌نیاز**: لاگین U3 (09351234567) — شمش `TSTRF001` به نام اوست

| ID | اقدام | گام‌به‌گام | نتیجه مورد انتظار | وضعیت |
|----|--------|-----------|-------------------|--------|
| TS-16-18 | باز کردن فرم انتقال | ۱. لاگین U3 (09351234567) ۲. منوی کشویی → «شمش‌های من» ۳. کنار شمش `TSTRF001` دکمه **«انتقال»** را بزنید | فرم انتقال با فیلد «شماره موبایل گیرنده» نمایش شود | ☐ |
| TS-16-19 | ارسال OTP انتقال | ۱. در فرم انتقال: شماره موبایل گیرنده: `09359876543` (U4) ۲. دکمه «ارسال کد تایید» را بزنید | پیام: کد تایید به موبایل شما (مالک فعلی) ارسال شد + فرم وارد کردن OTP نمایش شود. **نکته:** OTP در کنسول سرور چاپ می‌شود (حالت dev)، مقدار `111111` | ☐ |
| TS-16-20 | OTP اشتباه | ۱. در فرم OTP: کد تایید: `999999` (اشتباه) ۲. دکمه «تایید انتقال» | پیام خطا: کد تایید نادرست | ☐ |
| TS-16-21 | تایید انتقال موفق | ۱. در فرم OTP: کد تایید: `111111` ۲. دکمه «تایید انتقال» | پیام موفقیت: شمش با موفقیت منتقل شد | ☐ |
| TS-16-22 | بررسی انتقال — شمش در لیست گیرنده | ۱. لاگین U4 (09359876543) ۲. منوی کشویی → «شمش‌های من» | شمش `TSTRF001` در لیست U4 نمایش شود | ☐ |
| TS-16-23 | بررسی انتقال — شمش از لیست فرستنده حذف شده | ۱. لاگین U3 (09351234567) ۲. منوی کشویی → «شمش‌های من» | شمش `TSTRF001` دیگر در لیست U3 نباشد | ☐ |
| TS-16-24 | بررسی از پنل ادمین | ۱. لاگین ادمین → پنل مدیریت → شمش‌ها ۲. شمش `TSTRF001` را پیدا و ویرایش کنید | مالک: نام U4 + تاریخچه مالکیت شامل انتقال از U3 به U4 | ☐ |

---

## 17.5 TS-17: لاگ درخواست‌ها (Request Audit Log)

| ID | اقدام | ورودی | نتیجه مورد انتظار | وضعیت |
|----|--------|-------|-------------------|--------|
| TS-17-01 | لاگ GET ثبت شود | مرورگر → `/` (صفحه اصلی) | لاگ GET با status 200 در `/admin/logs` | ☐ |
| TS-17-02 | لاگ POST ثبت شود | ارسال فرم لاگین (OTP) | لاگ POST با body_preview (بدون `otp_code`) | ☐ |
| TS-17-03 | فیلتر متد | `/admin/logs?method=POST` | فقط لاگ‌های POST نمایش داده شود | ☐ |
| TS-17-04 | فیلتر نوع کاربر | `/admin/logs?user_type=customer` | فقط لاگ‌های مشتریان نمایش داده شود | ☐ |
| TS-17-05 | فیلتر وضعیت | `/admin/logs?status_group=4xx` | فقط لاگ‌های خطای 4xx نمایش داده شود | ☐ |
| TS-17-06 | مشاهده بدنه POST | کلیک روی آیکون چشم در لاگ POST | مودال با بدنه فرم (اطلاعات حساس mask شده) | ☐ |

---

## 18. TS-18: مدیریت کاربران (Customer Management)

| ID | اقدام | ورودی | نتیجه مورد انتظار | وضعیت |
|----|--------|-------|-------------------|--------|
| TC-CUST-ADMIN-01 | ناوبری به لیست مشتریان | ۱. لاگین ادمین (U1) ۲. از سایدبار «مدیریت کاربران» را کلیک کنید | صفحه `/admin/customers` باز شود — ۴ کارت آماری (کل مشتریان، فعال، ثبت‌نام امروز، دارای سفارش) + جدول صفحه‌بندی‌شده مشتریان نمایش داده شود | ☐ |
| TC-CUST-ADMIN-02 | جستجو بر اساس موبایل | ۱. در فیلد جستجو `09351234567` وارد کنید ۲. دکمه جستجو را بزنید | فقط مشتری U3 (09351234567) در نتایج نمایش داده شود | ☐ |
| TC-CUST-ADMIN-03 | فیلتر بر اساس وضعیت (فعال) | ۱. فیلتر وضعیت «فعال» را انتخاب کنید | فقط مشتریان فعال در جدول نمایش داده شوند — مشتریان غیرفعال حذف شوند | ☐ |
| TC-CUST-ADMIN-04 | مشاهده جزئیات مشتری — تب خلاصه | ۱. روی نام مشتری U3 کلیک کنید | صفحه جزئیات `/admin/customers/{id}` باز شود — تب خلاصه فعال باشد — اطلاعات مشتری (نام، موبایل، کد ملی) + کارت‌های موجودی کیف پول (IRR + XAU_MG) نمایش داده شود | ☐ |
| TC-CUST-ADMIN-05 | مشاهده تراکنش‌های کیف پول | ۱. در صفحه جزئیات مشتری U3 ۲. تب «کیف پول» را کلیک کنید | لیست صفحه‌بندی‌شده تراکنش‌های حسابداری (LedgerEntry) نمایش داده شود — شامل تراکنش‌های ریالی (IRR) و طلایی (XAU_MG) با نوع، مبلغ، توضیحات و تاریخ | ☐ |
| TC-CUST-ADMIN-06 | مشاهده سفارشات مشتری | ۱. در صفحه جزئیات مشتری U3 ۲. تب «سفارشات» را کلیک کنید | لیست صفحه‌بندی‌شده سفارشات مشتری نمایش داده شود — شامل شماره سفارش، وضعیت، مبلغ، روش تحویل و تاریخ | ☐ |
| TC-CUST-ADMIN-07 | مشاهده درخواست‌های برداشت | ۱. در صفحه جزئیات مشتری U3 ۲. تب «برداشت‌ها» را کلیک کنید | لیست صفحه‌بندی‌شده درخواست‌های برداشت مشتری نمایش داده شود — شامل مبلغ، وضعیت (در انتظار / تایید / رد)، شماره شبا و تاریخ | ☐ |
| TC-CUST-EDIT-01 | ویرایش نام مشتری و ذخیره | ۱. در صفحه جزئیات مشتری U3 ۲. تب خلاصه → فرم ویرایش ۳. نام را تغییر دهید (مثلاً «علی تست») ۴. دکمه «ذخیره» را بزنید | تغییرات ذخیره شود — پیام موفقیت نمایش داده شود — نام جدید در صفحه نمایش داده شود | ☐ |
| TC-CUST-EDIT-02 | تلاش برای ثبت موبایل تکراری | ۱. در فرم ویرایش مشتری U3 ۲. موبایل را به `09359876543` (موبایل مشتری U4) تغییر دهید ۳. ذخیره کنید | پیام خطای «شماره موبایل تکراری» نمایش داده شود — تغییرات ذخیره نشود | ☐ |
| TC-CUST-EDIT-03 | تغییر نوع مشتری به حقوقی | ۱. در فرم ویرایش مشتری U3 ۲. نوع مشتری را به «حقوقی» تغییر دهید ۳. نام شرکت و کد اقتصادی را وارد کنید ۴. ذخیره کنید | نوع مشتری به حقوقی تغییر کند — فیلدهای نام شرکت و کد اقتصادی ذخیره شوند — `display_name` مشتری نام شرکت را نمایش دهد | ☐ |
| TC-CUST-EDIT-04 | غیرفعال کردن مشتری | ۱. در فرم ویرایش مشتری U3 ۲. سوییچ «فعال» (`is_active`) را خاموش کنید ۳. ذخیره کنید | وضعیت مشتری به غیرفعال تغییر کند — badge وضعیت «غیرفعال» نمایش داده شود | ☐ |

---

## 19. TS-19: انتخاب بسته‌بندی مشتری (Customer Package Selection)

### مدیریت بسته‌بندی (ادمین)

| ID | اقدام | ورودی | نتیجه مورد انتظار | وضعیت |
|----|--------|-------|-------------------|--------|
| TC-PKG-01 | مشاهده لیست بسته‌بندی‌ها | لاگین ادمین → `/admin/packages` | ۴ بسته‌بندی نمایش داده شود — هر کدام با نام، قیمت (تومان)، وضعیت فعال و تصاویر | ☐ |
| TC-PKG-02 | ویرایش قیمت بسته‌بندی | قیمت «جعبه لوکس» را از ۵۰۰,۰۰۰ به ۶۰۰,۰۰۰ تومان تغییر دهید → ذخیره | قیمت جدید ذخیره شود — در صفحه محصول قیمت بروز نمایش داده شود | ☐ |
| TC-PKG-03 | غیرفعال کردن بسته‌بندی | تیک «فعال» را برای «پاکت ساده» بردارید → ذخیره | بسته‌بندی غیرفعال در صفحات مشتری نمایش داده نشود | ☐ |
| TC-PKG-04 | افزودن بسته‌بندی جدید | دکمه «افزودن بسته‌بندی» → نام: «صندوق فلزی» + قیمت: ۲,۰۰۰,۰۰۰ تومان → ذخیره | بسته‌بندی جدید در لیست ادمین و صفحات مشتری نمایش داده شود | ☐ |

### انتخاب بسته‌بندی (مشتری)

| ID | اقدام | ورودی | نتیجه مورد انتظار | وضعیت |
|----|--------|-------|-------------------|--------|
| TC-PKG-05 | مشاهده بسته‌بندی‌ها در صفحه محصول | لاگین مشتری (U3) → `/product/1` | بخش «انتخاب بسته‌بندی» نمایش داده شود — شامل «بدون بسته‌بندی خاص» (رایگان، پیش‌فرض) + بسته‌بندی‌های فعال با نام و قیمت | ☐ |
| TC-PKG-06 | افزودن به سبد با بسته‌بندی | «جعبه لوکس» را انتخاب → «افزودن به سبد خرید» | آیتم با بسته‌بندی «جعبه لوکس» به سبد اضافه شود | ☐ |
| TC-PKG-07 | تغییر بسته‌بندی در سبد خرید | `/cart` → dropdown بسته‌بندی آیتم → «جعبه هدیه ویژه» | بسته‌بندی تغییر کند — مبلغ خط سفارش بروزرسانی شود — «شامل بسته‌بندی» نمایش داده شود | ☐ |
| TC-PKG-08 | مبلغ بسته‌بندی در جمع سبد | سبد خرید با بسته‌بندی ۵۰۰,۰۰۰ تومان | جمع کل سبد = قیمت طلا + ۵۰۰,۰۰۰ تومان بسته‌بندی | ☐ |
| TC-PKG-09 | بسته‌بندی در صفحه چک‌اوت | `/checkout` با آیتم دارای بسته‌بندی | نام بسته‌بندی زیر نام محصول در خلاصه سفارش نمایش داده شود | ☐ |
| TC-PKG-10 | بسته‌بندی در جزئیات سفارش | پس از پرداخت → `/orders/{id}` | نام و قیمت بسته‌بندی در ریز فاکتور نمایش داده شود | ☐ |
| TC-PKG-11 | خرید بدون بسته‌بندی خاص | گزینه «بدون بسته‌بندی خاص» (پیش‌فرض) + افزودن به سبد | آیتم بدون بسته‌بندی به سبد اضافه شود — قیمت بسته‌بندی ۰ | ☐ |

---

## 20. TS-20: چند درگاه پرداخت (Multi-Gateway Payment)

**پیش‌نیاز**: لاگین U1 (super_admin) + سفارش Pending + لاگین U3 (مشتری)

### تغییر درگاه فعال

| ID | اقدام | ورودی | نتیجه مورد انتظار | وضعیت |
|----|--------|-------|-------------------|--------|
| TS-20-01 | مشاهده درگاه فعال در تنظیمات | U1 → `/admin/settings` | dropdown «درگاه پرداخت فعال» نمایش داده شود با مقدار فعلی | ☐ |
| TS-20-02 | تغییر درگاه به سپهر | U1 → تنظیمات → `active_gateway=sepehr` → ذخیره | تنظیم ذخیره شود + پیام موفقیت | ☐ |
| TS-20-03 | تغییر درگاه به تاپ | U1 → تنظیمات → `active_gateway=top` → ذخیره | تنظیم ذخیره شود + پیام موفقیت | ☐ |
| TS-20-04 | تغییر درگاه به پارسیان | U1 → تنظیمات → `active_gateway=parsian` → ذخیره | تنظیم ذخیره شود + پیام موفقیت | ☐ |
| TS-20-05 | برگرداندن درگاه به زیبال | U1 → تنظیمات → `active_gateway=zibal` → ذخیره | تنظیم ذخیره شود | ☐ |

### پرداخت سفارش با درگاه‌های مختلف

| ID | اقدام | ورودی | نتیجه مورد انتظار | وضعیت |
|----|--------|-------|-------------------|--------|
| TS-20-06 | پرداخت سفارش — درگاه زیبال | `active_gateway=zibal` + U3 → سفارش → «پرداخت آنلاین» | ریدایرکت به درگاه زیبال | ☐ |
| TS-20-07 | پرداخت سفارش — درگاه سپهر | `active_gateway=sepehr` + U3 → سفارش → «پرداخت آنلاین» | ریدایرکت به درگاه سپهر | ☐ |
| TS-20-08 | پرداخت سفارش — درگاه تاپ | `active_gateway=top` + U3 → سفارش → «پرداخت آنلاین» | ریدایرکت به درگاه تاپ | ☐ |
| TS-20-09 | پرداخت سفارش — درگاه پارسیان | `active_gateway=parsian` + U3 → سفارش → «پرداخت آنلاین» | ریدایرکت به درگاه پارسیان | ☐ |

### شارژ کیف پول با درگاه‌های مختلف

| ID | اقدام | ورودی | نتیجه مورد انتظار | وضعیت |
|----|--------|-------|-------------------|--------|
| TS-20-10 | شارژ کیف پول — درگاه زیبال | `active_gateway=zibal` + U3 → شارژ ۱M تومان | ریدایرکت به درگاه زیبال + callback به `/wallet/topup/zibal/callback` | ☐ |
| TS-20-11 | شارژ کیف پول — درگاه سپهر | `active_gateway=sepehr` + U3 → شارژ ۱M تومان | ریدایرکت به درگاه سپهر + callback به `/wallet/topup/sepehr/callback` | ☐ |
| TS-20-12 | بازگشت موفق شارژ (زیبال sandbox) | شارژ با زیبال → پرداخت موفق → callback | موجودی کیف پول افزایش یابد + فیلد `gateway` در WalletTopup = `zibal` | ☐ |
| TS-20-13 | بازگشت ناموفق شارژ | شارژ → لغو پرداخت | موجودی تغییر نکند + پیام خطا | ☐ |

### دسترسی و امنیت

| ID | اقدام | ورودی | نتیجه مورد انتظار | وضعیت |
|----|--------|-------|-------------------|--------|
| TS-20-14 | اپراتور تغییر درگاه | U2 (operator) → `/admin/settings` | دسترسی ندارد (فقط super_admin) — خطای 403 | ☐ |
| TS-20-15 | callback درگاه غلط | پرداخت با زیبال + callback به `/payment/sepehr/callback` | خطا / عدم تایید سفارش | ☐ |

---

## 21. TS-21: درخواست نمایندگی (Dealer Request)

### ثبت درخواست (مشتری)

| ID | اقدام | ورودی | نتیجه مورد انتظار | وضعیت |
|----|--------|-------|-------------------|--------|
| TS-21-01 | باز کردن فرم درخواست نمایندگی | لاگین U3 → `/dealer-request` | فرم ثبت درخواست نمایش داده شود (نام، موبایل، استان، شهر، مدارک) | ☐ |
| TS-21-02 | ثبت درخواست جدید | U3 → فرم را با اطلاعات معتبر + آپلود فایل پر کنید | ریدایرکت به صفحه وضعیت با پیام «درخواست شما با موفقیت ثبت شد» + وضعیت: در انتظار بررسی | ☐ |
| TS-21-03 | مشاهده وضعیت درخواست | U3 → `/dealer-request` (بعد از ثبت) | صفحه وضعیت نمایش شود با badge «در انتظار بررسی» (زرد) | ☐ |
| TS-21-04 | درخواست تکراری | U3 → `/dealer-request` (درخواست Pending موجود) | صفحه وضعیت نمایش شود (فرم جدید نمایش داده نشود) | ☐ |
| TS-21-05 | ثبت بدون نام | U3 → فرم بدون نام/نام خانوادگی | خطا: «نام و نام خانوادگی الزامی است» | ☐ |
| TS-21-06 | موبایل نامعتبر | U3 → فرم با موبایل `1234` | خطا: «شماره موبایل نامعتبر است» | ☐ |
| TS-21-07 | بیش از ۵ فایل | U3 → فرم با ۶ فایل پیوست | خطا: «حداکثر ۵ فایل مجاز است» | ☐ |

### بررسی درخواست (ادمین)

| ID | اقدام | ورودی | نتیجه مورد انتظار | وضعیت |
|----|--------|-------|-------------------|--------|
| TS-21-08 | لیست درخواست‌ها | U1 → `/admin/dealer-requests` | لیست درخواست‌ها با کارت‌های آماری (کل، در انتظار، تایید، رد، نیاز به اصلاح) | ☐ |
| TS-21-09 | فیلتر تب در انتظار | U1 → تب «در انتظار» | فقط درخواست‌های Pending نمایش شوند | ☐ |
| TS-21-10 | فیلتر تب نیاز به اصلاح | U1 → تب «نیاز به اصلاح» | فقط درخواست‌های RevisionNeeded نمایش شوند | ☐ |
| TS-21-11 | جزئیات درخواست | U1 → کلیک روی درخواست | صفحه جزئیات با اطلاعات مشتری + پیوست‌ها + دکمه‌های تایید/رد/اصلاح | ☐ |
| TS-21-12 | تایید درخواست | U1 → دکمه «تایید» + یادداشت اختیاری | وضعیت → تایید شده (سبز) | ☐ |
| TS-21-13 | رد درخواست | U1 → دکمه «رد» + یادداشت | وضعیت → رد شده (قرمز) | ☐ |

### جریان بازبینی (Revision Flow)

| ID | اقدام | ورودی | نتیجه مورد انتظار | وضعیت |
|----|--------|-------|-------------------|--------|
| TS-21-14 | ادمین درخواست اصلاح | U1 → دکمه «درخواست اصلاح» + یادداشت «لطفا مدرک هویتی واضح‌تر ارسال کنید» | وضعیت → نیاز به اصلاح (آبی) + یادداشت ادمین ثبت شود | ☐ |
| TS-21-15 | مشتری مشاهده وضعیت RevisionNeeded | U3 → `/dealer-request` | صفحه وضعیت با badge «نیاز به اصلاح» + یادداشت ادمین + دکمه «ویرایش و ارسال مجدد» | ☐ |
| TS-21-16 | مشتری ورود به حالت ویرایش | U3 → کلیک «ویرایش و ارسال مجدد» (= `/dealer-request?edit=1`) | فرم با اطلاعات قبلی پر شده نمایش شود | ☐ |
| TS-21-17 | مشتری ارسال مجدد | U3 → ویرایش اطلاعات + ارسال فرم | وضعیت از RevisionNeeded به Pending تغییر کند + یادداشت ادمین پاک شود | ☐ |
| TS-21-18 | ادمین بررسی مجدد | U1 → لیست درخواست‌ها → درخواست اصلاح‌شده | درخواست با وضعیت «در انتظار» و اطلاعات به‌روزشده نمایش شود | ☐ |
| TS-21-19 | ادمین تایید پس از اصلاح | U1 → تایید درخواست اصلاح‌شده | وضعیت → تایید شده | ☐ |
| TS-21-20 | edit=1 روی درخواست Pending | U3 → `/dealer-request?edit=1` (درخواست Pending) | صفحه وضعیت نمایش شود (نه فرم ویرایش) — ویرایش فقط برای RevisionNeeded مجاز | ☐ |
| TS-21-21 | جستجو در لیست ادمین | U1 → جستجو بر اساس نام یا موبایل | نتایج فیلتر شوند | ☐ |

---

## 22. TS-22: پیگیری تحویل فیزیکی و طلای امانی (Bar Delivery Tracking & Custodial Gold)

### فروش حضوری (POS) — تحویل فوری

**پیش‌نیاز**: لاگین نماینده D1 + شمش ASSIGNED در شعبه

| ID | اقدام | ورودی | نتیجه مورد انتظار | وضعیت |
|----|--------|-------|-------------------|--------|
| TS-22-01 | فروش POS — ثبت تحویل فوری | `/dealer/pos` → فروش شمش → بررسی شمش در `/admin/bars` | شمش وضعیت SOLD + فیلد `delivered_at` مقداردهی شده (برابر زمان فروش) | ☐ |
| TS-22-02 | فروش POS API — ثبت تحویل فوری | `POST /api/dealer/sale` → بررسی شمش در DB | شمش وضعیت SOLD + `delivered_at` مقداردهی شده | ☐ |

### سفارش آنلاین — تحویل با تایید ادمین

**پیش‌نیاز**: لاگین U3 (مشتری) + سفارش پرداخت‌شده (Paid)

| ID | اقدام | ورودی | نتیجه مورد انتظار | وضعیت |
|----|--------|-------|-------------------|--------|
| TS-22-03 | سفارش آنلاین — شمش قبل از تحویل | U3 → ثبت و پرداخت سفارش → بررسی شمش در `/admin/bars` | شمش وضعیت SOLD + `delivered_at` خالی (NULL) = طلای امانی | ☐ |
| TS-22-04 | تایید تحویل توسط ادمین | U1 → `/admin/orders` → سفارش Paid → وضعیت تحویل به «تحویل‌شده» | تمام شمش‌های سفارش: `delivered_at` مقداردهی شود + دیگر امانی نباشند | ☐ |
| TS-22-05 | سفارش چند شمشی — تحویل همزمان | U3 → سفارش با ۲+ شمش → پرداخت → ادمین تایید تحویل | `delivered_at` همه شمش‌های سفارش مقداردهی شود | ☐ |

### طلای امانی پس از انتقال مالکیت

**پیش‌نیاز**: شمش SOLD متعلق به U3 با `delivered_at` خالی (NULL)

| ID | اقدام | ورودی | نتیجه مورد انتظار | وضعیت |
|----|--------|-------|-------------------|--------|
| TS-22-06 | انتقال مالکیت — حفظ وضعیت امانی | U3 → انتقال شمش (بدون تحویل فیزیکی) به U4 → بررسی شمش | مالک جدید: U4 + `delivered_at` همچنان خالی (NULL) = شمش هنوز امانی است | ☐ |
| TS-22-07 | تحویل پس از انتقال | ادمین تحویل سفارش اصلی را تایید می‌کند | `delivered_at` مقداردهی شود — شمش دیگر امانی نیست (حتی با مالک جدید) | ☐ |

### سفارش هدیه — تحویل فیزیکی

| ID | اقدام | ورودی | نتیجه مورد انتظار | وضعیت |
|----|--------|-------|-------------------|--------|
| TS-22-08 | سفارش هدیه — شمش قبل از تحویل | U3 → سفارش هدیه + پرداخت → بررسی شمش | شمش SOLD + user_id خالی + claim_code تولید‌شده + `delivered_at` خالی (NULL) | ☐ |
| TS-22-09 | سفارش هدیه — تایید تحویل | ادمین تحویل سفارش هدیه را تایید کند | `delivered_at` مقداردهی شود — حتی اگر هنوز claim نشده باشد | ☐ |

### نمایش خریدار و مالک فعلی در پنل ادمین

**پیش‌نیاز**: `seed.py --reset` اجرا شده (شمش‌های TSCST001-003 ساخته شده)

| ID | اقدام | ورودی | نتیجه مورد انتظار | وضعیت |
|----|--------|-------|-------------------|--------|
| TS-22-10 | طلای امانی — نمایش خریدار و مالک | U1 → `/admin/orders` → باز کردن بخش «طلای امانی» | TSCST001: خریدار=U3، مالک=U3 / TSCST002: خریدار=U3، مالک=U4 (بج «انتقال یافته») | ☐ |
| TS-22-11 | نقره امانی — نمایش خریدار و مالک | U1 → `/admin/orders` → باز کردن بخش «نقره امانی» | TSCST003: خریدار=U3، مالک=U3 + نام و موبایل نمایش داده شود | ☐ |

---

## 23. TS-23: نظرات و پرسش‌وپاسخ محصول (Reviews & Comments)

### ثبت نظر ستاره‌ای (Product Review)

**پیش‌نیاز**: لاگین U3 (مشتری) + حداقل یک سفارش پرداخت‌شده

| ID | اقدام | ورودی | نتیجه مورد انتظار | وضعیت |
|----|--------|-------|-------------------|--------|
| TS-23-01 | ثبت نظر ستاره‌ای از صفحه سفارش | لاگین U3 → `/orders/{id}` → فرم نظر (۵ ستاره + متن) | نظر ثبت و ریدایرکت به صفحه سفارش | ☐ |
| TS-23-02 | تکراری بودن نظر | نظر دوباره برای همان آیتم سفارش | پیام «قبلاً نظر ثبت کرده‌اید» | ☐ |

### کامنت و پرسش‌وپاسخ (Product Comment / Q&A)

**پیش‌نیاز**: لاگین U3 (مشتری)

| ID | اقدام | ورودی | نتیجه مورد انتظار | وضعیت |
|----|--------|-------|-------------------|--------|
| TS-23-03 | ثبت کامنت/پرسش در صفحه محصول | لاگین U3 → `/product/{id}` → فرم کامنت | کامنت ثبت و ریدایرکت به `#comments` | ☐ |
| TS-23-04 | لایک/آنلایک کامنت (AJAX) | کلیک لایک روی کامنت | تعداد لایک +۱ یا -۱ | ☐ |

### مدیریت نظرات و کامنت‌ها در پنل ادمین

**پیش‌نیاز**: لاگین U1 (Super Admin)

| ID | اقدام | ورودی | نتیجه مورد انتظار | وضعیت |
|----|--------|-------|-------------------|--------|
| TS-23-05 | پاسخ ادمین به کامنت | لاگین U1 → `/admin/reviews/comment/{id}` → پاسخ | پاسخ ادمین زیر کامنت نمایش داده می‌شود | ☐ |
| TS-23-06 | پاسخ ادمین به نظر ستاره‌ای | لاگین U1 → `/admin/reviews/review/{id}` → پاسخ | پاسخ ادمین در جزئیات نظر نمایش داده می‌شود | ☐ |
| TS-23-07 | حذف کامنت توسط ادمین | لاگین U1 → `/admin/reviews/comment/{id}/delete` | کامنت حذف و ریدایرکت | ☐ |
| TS-23-08 | لیست نظرات در پنل ادمین | لاگین U1 → `/admin/reviews` | تب‌های نظرات و کامنت‌ها + جستجو | ☐ |

---

## 24. TS-24: API دستگاه POS مشتری‌محور (Customer-Facing POS API)

### دریافت اطلاعات محصول

**پیش‌نیاز**: API Key نماینده D1 (`test_esfahan_key_0000000000000000`)

| ID | اقدام | ورودی | نتیجه مورد انتظار | وضعیت |
|----|--------|-------|-------------------|--------|
| TS-24-01 | دریافت دسته‌بندی‌ها | `GET /api/pos/categories` (API Key D1) | لیست دسته‌بندی‌ها با تعداد محصول | ☐ |
| TS-24-02 | دریافت محصولات با قیمت | `GET /api/pos/products` (API Key D1) | محصولات با قیمت لحظه‌ای و موجودی | ☐ |

### فرآیند فروش (Reserve → Confirm)

**پیش‌نیاز**: API Key نماینده D1 + شمش ASSIGNED در شعبه

| ID | اقدام | ورودی | نتیجه مورد انتظار | وضعیت |
|----|--------|-------|-------------------|--------|
| TS-24-03 | رزرو شمش | `POST /api/pos/reserve` `{"product_id": 1}` | `bar_id` + `expires_at` (۲ دقیقه) | ☐ |
| TS-24-04 | تایید فروش بعد از پرداخت | `POST /api/pos/confirm` `{"bar_id": X, "payment_amount": Y}` | `sale_id` + `claim_code` + `serial_code` | ☐ |
| TS-24-05 | لغو رزرو | `POST /api/pos/cancel` `{"bar_id": X}` | شمش به وضعیت ASSIGNED برمی‌گردد | ☐ |
| TS-24-06 | رسید فروش | `GET /api/pos/receipt/{sale_id}` | اطلاعات کامل رسید | ☐ |

### تست‌های خطا و حالات مرزی

| ID | اقدام | ورودی | نتیجه مورد انتظار | وضعیت |
|----|--------|-------|-------------------|--------|
| TS-24-07 | رزرو بدون موجودی | `POST /api/pos/reserve` (محصول بدون موجودی) | خطای «موجودی تمام شده» | ☐ |
| TS-24-08 | مغایرت قیمت در تایید | `POST /api/pos/confirm` (مبلغ اشتباه) | خطای «مبلغ مطابقت ندارد» | ☐ |

---

## 25. TS-25: یکپارچه‌سازی دستگاه POS راسیس (Rasis POS Integration)

### پیش‌نیاز
- `rasis_pos_enabled` در تنظیمات ادمین فعال باشد
- متغیرهای محیطی `RASIS_API_URL`، `RASIS_USERNAME`، `RASIS_PASSWORD` تنظیم شده باشند
- نماینده‌ای با فیلد `rasis_sharepoint` تنظیم‌شده وجود داشته باشد

| ID | اقدام | ورودی | نتیجه مورد انتظار | وضعیت |
|----|--------|-------|-------------------|--------|
| TC-RAS-001 | فعال/غیرفعال‌سازی Rasis از تنظیمات ادمین | لاگین U1 → `/admin/settings` → تغییر `rasis_pos_enabled` | تنظیم ذخیره شود + همگام‌سازی‌های خودکار فقط در حالت فعال اجرا شوند | ☐ |
| TC-RAS-002 | ایجاد نماینده با rasis_sharepoint → ثبت خودکار در راسیس | لاگین U1 → ایجاد/ویرایش نماینده → تنظیم `rasis_sharepoint` | نماینده در سیستم راسیس ثبت شود (لاگ سرویس بررسی شود) | ☐ |
| TC-RAS-003 | تخصیص شمش به نماینده → افزودن کالا به POS | ادمین → انبار → تخصیص شمش به نماینده‌ای با `rasis_sharepoint` | کالا (شمش) به‌صورت خودکار در دستگاه POS راسیس اضافه شود | ☐ |
| TC-RAS-004 | فروش شمش → حذف کالا از POS | نماینده → فروش POS یک شمش / تایید فروش POS مشتری‌محور / نهایی‌سازی سفارش آنلاین | کالا (شمش) به‌صورت خودکار از دستگاه POS راسیس حذف شود | ☐ |
| TC-RAS-005 | همگام‌سازی دستی از صفحه ویرایش نماینده | لاگین U1 → `/admin/dealers/{id}` → کلیک «همگام‌سازی راسیس» | همگام‌سازی کامل (full sync) موجودی + قیمت اجرا شود + پیام موفقیت نمایش داده شود | ☐ |
| TC-RAS-006 | بروزرسانی خودکار قیمت (background scheduler) | تغییر قیمت طلا از تنظیمات ادمین → صبر ۵ دقیقه | قیمت‌های جدید به‌صورت خودکار به تمام دستگاه‌های POS راسیس فعال ارسال شوند (لاگ بررسی شود) | ☐ |

---

## 26. TS-26: قیمت‌گذاری چندفلزی (Metal-Aware Pricing)

### قیمت‌گذاری محصولات بر اساس نوع فلز

**پیش‌نیاز**: `seed.py --reset` + محصولات طلا (`metal_type=gold`) و نقره (`metal_type=silver`) در سیستم

| ID | اقدام | ورودی | نتیجه مورد انتظار | وضعیت |
|----|--------|-------|-------------------|--------|
| TC-METAL-01 | قیمت‌گذاری محصول طلا | مرورگر → `/` → مشاهده محصول طلا | قیمت بر اساس `gold_18k` از جدول Asset + `base_purity=750` محاسبه شود — فرمول: `(gold_price / 750) × purity × weight` | ☐ |
| TC-METAL-02 | قیمت‌گذاری محصول نقره | مرورگر → `/` → مشاهده محصول نقره | قیمت بر اساس `silver` از جدول Asset + `base_purity=999` محاسبه شود — فرمول: `(silver_price / 999) × purity × weight` | ☐ |
| TC-METAL-03 | فروش POS شمش طلا — واریز سود | لاگین D1 → `/dealer/pos` → فروش شمش طلا | سود فلزی (`metal_profit_mg`) به کیف پول **XAU_MG** نماینده واریز شود | ☐ |
| TC-METAL-04 | فروش POS شمش نقره — واریز سود | لاگین D1 → `/dealer/pos` → فروش شمش نقره | سود فلزی (`metal_profit_mg`) به کیف پول **XAG_MG** نماینده واریز شود | ☐ |
| TC-METAL-05 | سبد مختلط طلا + نقره | لاگین U3 → افزودن محصول طلا + محصول نقره به سبد → `/cart` | هر آیتم با قیمت فلز خودش قیمت‌گذاری شود: طلا با `gold_18k` و نقره با `silver` — جمع کل = مجموع هر دو | ☐ |
| TC-METAL-06 | بلاک checkout با قیمت نقره منقضی | قیمت طلا تازه + قیمت نقره منقضی (بیش از آستانه) → سبد با محصول نقره → ثبت سفارش | خطا: «قیمت نقره به‌روز نیست» — سفارش ثبت نشود (حتی اگر قیمت طلا تازه باشد) | ☐ |
| TC-METAL-07 | گزارش فروش نمایندگان — تفکیک فلز | لاگین U1 → `/admin/dealers/sales` (بعد از فروش طلا و نقره) | ستون `metal_type` در جدول فروش‌ها نمایش داده شود — آمار تجمیعی سود فلزی به‌تفکیک طلا/نقره | ☐ |

---

## 27. TS-27: داشبورد B2B نمایندگان (Dealer B2B Dashboard)

### 21A: موجودی فیزیکی نماینده (Dealer Physical Inventory)

| ID | اقدام | ورودی | نتیجه مورد انتظار | وضعیت |
|----|--------|-------|-------------------|--------|
| TP-21A-01 | مشاهده موجودی فیزیکی نماینده | لاگین D1 (09161234567) → `/dealer/inventory` | لیست شمش‌های موجود در لوکیشن نماینده نمایش داده شود با فیلترهای (`metal_type`، `status`) و آمار تجمیعی (تعداد کل، ارزش موجودی) | ☐ |

### 21B: داشبورد تحلیلی نماینده (Analytics Dashboard)

| ID | اقدام | ورودی | نتیجه مورد انتظار | وضعیت |
|----|--------|-------|-------------------|--------|
| TP-21B-01 | مشاهده داشبورد تحلیلی نماینده | لاگین D1 → `/dealer/dashboard` | نمودارهای Chart.js نمایش داده شوند: روند فروش (۳۰ روز اخیر)، نمودار دایره‌ای سود فلزی، مقایسه دوره‌ای، ارزش موجودی | ☐ |

### 21C: شبکه زیرنمایندگان (Sub-dealer Network)

| ID | اقدام | ورودی | نتیجه مورد انتظار | وضعیت |
|----|--------|-------|-------------------|--------|
| TP-21C-01 | مدیریت زیرنمایندگان از پنل ادمین | لاگین U1 → `/admin/dealers/{id}/sub-dealers` | لیست روابط زیرنمایندگی نمایش داده شود + فرم افزودن زیرنماینده + دکمه غیرفعال‌سازی | ☐ |
| TP-21C-02 | فروش POS با تقسیم سود بین نماینده اصلی و زیرنماینده | فروش POS توسط زیرنماینده (که نماینده اصلی دارد) | سود فلزی (`metal_profit_mg`) تقسیم شود: X% به نماینده اصلی (parent)، باقی به زیرنماینده (child) — واریز به کیف پول هر دو بررسی شود | ☐ |
| TP-21C-03 | مشاهده شبکه زیرنمایندگان از پنل نماینده | لاگین D1 → `/dealer/sub-dealers` | نمای فقط‌خواندنی: نماینده اصلی (parent) + لیست زیرنمایندگان + آمار کمیسیون | ☐ |

### 21D: سفارش عمده نمایندگان (B2B Bulk Orders)

| ID | اقدام | ورودی | نتیجه مورد انتظار | وضعیت |
|----|--------|-------|-------------------|--------|
| TP-21D-01 | مشاهده کاتالوگ سفارش عمده | لاگین D1 → `/dealer/b2b-orders/new` | کاتالوگ محصولات با قیمت‌گذاری سطح نماینده (tier pricing) و موجودی انبار مرکزی نمایش داده شود | ☐ |
| TP-21D-02 | ثبت سفارش عمده | انتخاب محصولات + تعداد → ارسال فرم | سفارش با وضعیت `Submitted` ایجاد شود، قیمت‌ها قفل (lock) شوند | ☐ |
| TP-21D-03 | تایید سفارش عمده توسط ادمین | لاگین U1 → `/admin/dealers/b2b-orders/{id}` → کلیک «تایید» | وضعیت سفارش به `Approved` تغییر کند | ☐ |
| TP-21D-04 | پرداخت سفارش عمده از کیف پول | لاگین D1 → پرداخت سفارش تایید‌شده از کیف پول | وضعیت به `Paid` تغییر کند، موجودی کیف پول نماینده کسر شود | ☐ |
| TP-21D-05 | تحویل سفارش عمده توسط ادمین | لاگین U1 → `/admin/dealers/b2b-orders/{id}` → کلیک «تحویل» | شمش‌ها از انبار مرکزی به نماینده منتقل شوند، وضعیت به `Fulfilled` تغییر کند | ☐ |
| TP-21D-06 | لغو سفارش عمده (وضعیت Submitted) | لاگین D1 → لغو سفارش با وضعیت `Submitted` | وضعیت به `Cancelled` تغییر کند، بدون بازگشت وجه (هنوز پرداخت نشده) | ☐ |
| TP-21D-07 | لغو سفارش عمده (وضعیت Paid) | لاگین D1 → لغو سفارش با وضعیت `Paid` | وضعیت به `Cancelled` تغییر کند + مبلغ پرداخت‌شده به کیف پول نماینده بازگردانده شود (refund) | ☐ |

---

## 28. TS-28: انبارگردانی پیشرفته و رهگیری فیزیکی (Advanced Inventory & Physical Tracking)

### اسکنر شمش (Bar Scanner)

**پیش‌نیاز**: لاگین U1 (Super Admin) یا D1 (نماینده) + شمش‌های ASSIGNED در سیستم

| ID | اقدام | ورودی | نتیجه مورد انتظار | وضعیت |
|----|--------|-------|-------------------|--------|
| TC-SCAN-01 | اسکن شمش از پنل ادمین | لاگین U1 → `/admin/bars` → کلیک اسکنر → وارد کردن سریال شمش موجود | نتیجه AJAX: اطلاعات شمش (سریال، وضعیت، محصول، نماینده) + لینک ویرایش نمایش داده شود | ☐ |
| TC-SCAN-02 | اسکن شمش از پنل نماینده | لاگین D1 → `/dealer/inventory` → کلیک اسکنر → وارد کردن سریال شمش | نتیجه AJAX: اطلاعات شمش + بج «در انبار شما» یا «در انبار شما نیست» نمایش داده شود | ☐ |

### انبارگردانی (Reconciliation)

**پیش‌نیاز**: لاگین U1 (ادمین) یا D1 (نماینده) + شمش‌های ASSIGNED به نماینده D1

| ID | اقدام | ورودی | نتیجه مورد انتظار | وضعیت |
|----|--------|-------|-------------------|--------|
| TC-RECON-01 | شروع جلسه انبارگردانی | لاگین U1 → `/admin/reconciliation` → انتخاب نماینده D1 → کلیک «شروع انبارگردانی» | جلسه جدید با وضعیت `InProgress` ایجاد شود + ریدایرکت به صفحه جزئیات جلسه با اسکنر | ☐ |
| TC-RECON-02 | اسکن شمش — تطابق (Matched) | در جلسه فعال → اسکن سریال شمشی که در انبار D1 ثبت شده (ASSIGNED به D1) | آیتم با وضعیت `Matched` (سبز) ثبت شود + شمارنده اسکن‌شده +۱ | ☐ |
| TC-RECON-03 | اسکن شمش — اضافی (Unexpected) | در جلسه فعال → اسکن سریال شمشی که در انبار D1 ثبت **نیست** (مثلاً شمش نماینده دیگر) | آیتم با وضعیت `Unexpected` (نارنجی) ثبت شود + هشدار نمایش داده شود | ☐ |
| TC-RECON-04 | نهایی‌سازی انبارگردانی | در جلسه فعال → کلیک «نهایی‌سازی» (بعد از اسکن بخشی از شمش‌ها) | وضعیت جلسه → `Completed` + آیتم‌های Missing تولید شوند (شمش‌های در سیستم که اسکن نشده‌اند) + آمار تجمیعی محاسبه شود (total_expected, total_scanned, total_matched, total_missing, total_unexpected) | ☐ |
| TC-RECON-05 | لغو انبارگردانی | در جلسه فعال → کلیک «لغو» | وضعیت جلسه → `Cancelled` + بازگشت به لیست جلسات | ☐ |

### تحویل امانی (Custodial Delivery)

**پیش‌نیاز**: لاگین U3 (مشتری) + شمش SOLD با `delivered_at IS NULL` (امانی) متعلق به U3

| ID | اقدام | ورودی | نتیجه مورد انتظار | وضعیت |
|----|--------|-------|-------------------|--------|
| TC-CDLV-01 | ثبت درخواست تحویل امانی | لاگین U3 → `/my-bars` → شمش امانی → «درخواست تحویل» → انتخاب نماینده | درخواست تحویل با وضعیت `Pending` ایجاد شود + ریدایرکت به صفحه شمش | ☐ |
| TC-CDLV-02 | ارسال OTP تحویل | لاگین U3 → `/my-bars/{bar_id}/delivery/{req_id}/send-otp` | OTP به موبایل مشتری ارسال شود (محیط توسعه: `111111`) + پیام «کد تایید ارسال شد» | ☐ |
| TC-CDLV-03 | تایید تحویل توسط نماینده | لاگین D1 → `/dealer/deliveries/{req_id}` → وارد کردن OTP + سریال‌کد شمش → کلیک «تایید تحویل» | وضعیت درخواست → `Completed` + فیلد `delivered_at` شمش مقداردهی شود + شمش دیگر امانی نباشد | ☐ |
| TC-CDLV-04 | لغو درخواست تحویل | لاگین U3 → `/my-bars/{bar_id}/delivery/{req_id}/cancel` | وضعیت درخواست → `Cancelled` + شمش همچنان امانی باقی بماند | ☐ |

### رهگیری نوع انتقال (Transfer Audit Trail)

**پیش‌نیاز**: `seed.py --reset` + سفارش عمده B2B تحویل‌شده (Fulfilled) + شمش با تاریخچه انتقال

| ID | اقدام | ورودی | نتیجه مورد انتظار | وضعیت |
|----|--------|-------|-------------------|--------|
| TC-AUDIT-01 | ثبت نوع انتقال در تحویل سفارش عمده | U1 → تحویل (fulfill) سفارش عمده B2B → بررسی رکورد DealerTransfer | فیلد `transfer_type` = `B2BFulfillment` + فیلد `reference_type` = `b2b_order` + فیلد `reference_id` = شناسه سفارش عمده | ☐ |
| TC-AUDIT-02 | نمایش بج نوع انتقال در جزئیات شمش ادمین | U1 → `/admin/bars/edit/{bar_id}` → بخش تاریخچه انتقال | هر رکورد انتقال دارای بج رنگی نوع انتقال باشد (مثلاً «تحویل سفارش عمده» آبی، «دستی» خاکستری، «تحویل امانی» سبز) | ☐ |

---

## 29. TS-NEG: تست‌های منفی

### امنیت و دسترسی

| ID | اقدام | ورودی | نتیجه مورد انتظار | وضعیت |
|----|--------|-------|-------------------|--------|
| TS-NEG-01 | دسترسی ادمین بدون لاگین | مرورگر → `/admin/dashboard` بدون کوکی | ریدایرکت به `/auth/login` یا خطای 401 | ☐ |
| TS-NEG-02 | دسترسی نماینده بدون لاگین | مرورگر → `/dealer/dashboard` بدون کوکی | ریدایرکت به `/auth/login` یا خطای 401 | ☐ |
| TS-NEG-03 | مشتری به پنل ادمین | لاگین مشتری → `/admin/dashboard` | خطای 401/403 | ☐ |
| TS-NEG-04 | نماینده به پنل ادمین | لاگین نماینده → `/admin/dashboard` | خطای 401/403 | ☐ |
| TS-NEG-05 | مشتری به پنل نماینده | لاگین مشتری → `/dealer/dashboard` | خطای 401/403 | ☐ |
| TS-NEG-06 | اپراتور به تنظیمات سیستم | لاگین U2 (operator) → `/admin/settings` | خطای 403 (فقط super_admin) | ☐ |
| TS-NEG-07 | CSRF token نامعتبر | ارسال فرم POST بدون/با CSRF نامعتبر | خطای CSRF | ☐ |

### ورودی‌های نامعتبر

| ID | اقدام | ورودی | نتیجه مورد انتظار | وضعیت |
|----|--------|-------|-------------------|--------|
| TS-NEG-08 | ایجاد محصول — وزن منفی | وزن: `-1` | خطای اعتبارسنجی | ☐ |
| TS-NEG-09 | ایجاد محصول — عیار نامعتبر | عیار: `0` | خطای اعتبارسنجی یا قیمت صفر | ☐ |
| TS-NEG-10 | ایجاد نماینده — موبایل تکراری | موبایل نماینده‌ای که وجود دارد | خطا: «این شماره قبلاً ثبت شده» | ☐ |
| TS-NEG-11 | کوپن — کد تکراری | ایجاد کوپن با کد موجود | خطا: «کد تکراری» | ☐ |
| TS-NEG-12 | برداشت — شبا نامعتبر | شبا: `12345` | خطای اعتبارسنجی | ☐ |
| TS-NEG-13 | تغییر قیمت طلا — عدد منفی | قیمت: `-1000` | خطای اعتبارسنجی | ☐ |
| TS-NEG-14 | ثبت سفارش — سبد خالی | رفتن به checkout با سبد خالی | ریدایرکت به سبد یا خطا | ☐ |
| TS-NEG-15 | پرداخت سفارش دیگری | مشتری A → پرداخت سفارش مشتری B | خطای 403 / عدم دسترسی | ☐ |

### تحمل خطا

| ID | اقدام | ورودی | نتیجه مورد انتظار | وضعیت |
|----|--------|-------|-------------------|--------|
| TS-NEG-16 | سفارش محصول بدون شمش | خرید محصولی که شمش Assigned ندارد | خطا: «موجودی کافی نیست» | ☐ |
| TS-NEG-17 | دابل‌کلیک پرداخت | دو بار سریع کلیک روی «پرداخت با کیف پول» | فقط یک بار پرداخت شود (idempotency) | ☐ |
| TS-NEG-18 | بازخرید شمش فروخته‌نشده | نماینده → بازخرید → سریال شمش Assigned | خطا: «شمش قابل بازخرید نیست» | ☐ |
| TS-NEG-19 | صفحه ناموجود | مرورگر → `/admin/nonexistent` | صفحه سفارشی ۴۰۴ با پیام فارسی | ☐ |
| TS-NEG-20 | Health check | مرورگر → `/health` | پاسخ 200 با وضعیت سلامت | ☐ |
| TS-NEG-21 | ثبت مالکیت شمش بدون claim_code | سریال‌کد شمش عادی (فروش آنلاین، بدون claim_code) + هر کدی | خطا: شمش کد ثبت مالکیت ندارد | ☐ |
| TS-NEG-22 | انتقال شمشی که مالک نیستی | لاگین U4 → `/my-bars/{bar_id}/transfer` (شمش U3) | خطای 403 | ☐ |
| TS-NEG-23 | انتقال شمش به خودت | لاگین U3 → انتقال شمش به موبایل خود U3 | خطا: نمی‌توانید شمش را به خودتان منتقل کنید | ☐ |
| TS-NEG-24 | مشاهده my-bars بدون لاگین | بدون لاگین → `/my-bars` | ریدایرکت به صفحه ورود | ☐ |
| TS-NEG-25 | OTP انتقال منقضی‌شده | OTP ارسال شده + صبر تا انقضا → وارد کردن OTP | خطا: کد تایید منقضی شده | ☐ |

---

## خلاصه تعداد تست‌ها

| بخش | تعداد |
|------|--------|
| TS-01: احراز هویت | ۱۰ |
| TS-02: فروشگاه | ۸ |
| TS-03: سبد خرید | ۶ |
| TS-04: ثبت سفارش | ۹ |
| TS-05: پرداخت | ۶ |
| TS-06: کیف پول | ۲۱ |
| TS-07: کوپن | ۱۷ |
| TS-08: پنل مدیریت | ۴۲ |
| TS-09: نمایندگان | ۲۷ |
| TS-10: احراز اصالت | ۴ |
| TS-11: پروفایل و آدرس | ۱۲ |
| TS-12: تیکتینگ / پشتیبانی | ۳۳ |
| TS-13: POS REST API نماینده | ۱۸ |
| TS-14: بازپرداخت اجرت بازخرید | ۶ |
| TS-15: صفحات ثابت و فوتر | ۱۵ |
| TS-16: ثبت مالکیت، خرید هدیه و انتقال شمش | ۲۴ |
| TS-17: لاگ درخواست‌ها | ۶ |
| TS-18: مدیریت کاربران | ۱۱ |
| TS-19: انتخاب بسته‌بندی مشتری | ۱۱ |
| TS-20: چند درگاه پرداخت | ۱۵ |
| TS-21: درخواست نمایندگی | ۲۱ |
| TS-22: پیگیری تحویل فیزیکی و طلای امانی | ۱۱ |
| TS-23: نظرات و پرسش‌وپاسخ محصول | ۸ |
| TS-24: API دستگاه POS مشتری‌محور | ۸ |
| TS-25: یکپارچه‌سازی دستگاه POS راسیس | ۶ |
| TS-26: قیمت‌گذاری چندفلزی | ۷ |
| TS-27: داشبورد B2B نمایندگان | ۱۱ |
| TS-28: انبارگردانی پیشرفته و رهگیری فیزیکی | ۱۳ |
| TS-NEG: تست‌های منفی | ۲۵ |
| **مجموع** | **۳۹۸** |

---

> این سند بر اساس قابلیت‌های فعلی سیستم TalaMala v4 (فازهای ۱-۱۴، ۲۱ و ۲۲ + بازپرداخت اجرت بازخرید + بهبودهای تیکتینگ + صفحات ثابت و فوتر + ثبت مالکیت و انتقال شمش + ادغام Location در Dealer + لاگ درخواست‌ها + مدیریت کاربران + ویرایش مشتری توسط ادمین + انتخاب بسته‌بندی مشتری + گزارش فروش POS ادمین + مدیریت دارایی و قیمت‌گذاری خودکار + چند درگاه پرداخت + درخواست نمایندگی با بازبینی + پیگیری تحویل فیزیکی و طلای امانی + نظرات و پرسش‌وپاسخ محصول + API دستگاه POS مشتری‌محور + یکپارچه‌سازی دستگاه POS راسیس + داشبورد B2B نمایندگان + انبارگردانی پیشرفته و رهگیری فیزیکی + سیستم دسترسی سلسله‌مراتبی اپراتور) تهیه شده است.
> ستون «وضعیت» را پس از اجرای هر تست با علامت ✅ (موفق)، ❌ (ناموفق) یا ⚠️ (نیاز به بررسی) پر کنید.
