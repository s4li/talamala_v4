# ๐ ุทูุงููุง v4 - ุณุณุชู ูุฏุฑุช ุดูุด ุทูุง

## ๐ ูุงุฒ ฑ ู ฒ: ุฒุฑุณุงุฎุช + ูุงฺูู ุงุญุฑุงุฒ ููุช

---

## โก ุฑุงูโุงูุฏุงุฒ ุณุฑุน

### ฑ. ูพุดโูุงุฒูุง
- Python 3.11+
- PostgreSQL 14+

### ฒ. ุฏุงูููุฏ ู ุงุณุชุฎุฑุงุฌ
```bash
unzip talamala_v4.zip
cd talamala_v4
```

### ณ. ุณุงุฎุช ูุญุท ูุฌุงุฒ
```bash
python -m venv venv

# ูููฺฉุณ/ูฺฉ:
source venv/bin/activate

# ููุฏูุฒ:
venv\Scripts\activate
```

### ด. ูุตุจ ูพฺฉุฌโูุง
```bash
pip install -r requirements.txt
```

### ต. ุชูุธู ุฏุชุงุจุณ
```bash
# ูุฑูุฏ ุจู PostgreSQL
sudo -u postgres psql

# ุงุฌุงุฏ ุฏุชุงุจุณ
CREATE DATABASE talamala_v4;
\q
```

### ถ. ูุงู env.
```bash
cp .env.example .env
# ูุฑุงุด .env ู ุชูุธู ููุงุฏุฑ:
#   DB_USER, DB_PASSWORD, DB_NAME
#   SECRET_KEY (ฺฉ ุฑุดุชู ุชุตุงุฏู 64 ฺฉุงุฑุงฺฉุชุฑ)
#   CUSTOMER_SECRET_KEY (ฺฉ ุฑุดุชู ุชุตุงุฏู ุฏฺฏุฑ)
#   OTP_SECRET (ฺฉ ุฑุดุชู ุชุตุงุฏู ุฏฺฏุฑ)
```

ุจุฑุง ุชููุฏ ฺฉูุฏ ุชุตุงุฏู:
```bash
python -c "import secrets; print(secrets.token_urlsafe(48))"
```

### ท. ุงุฌุฑุง ูุงฺฏุฑุดู
```bash
alembic revision --autogenerate -m "init phase1 phase2"
alembic upgrade head
```

### ธ. ุฏุงุฏูโูุง ุงููู
```bash
python scripts/seed.py
```

### น. ุงุฌุฑุง ุณุฑูุฑ
```bash
uvicorn main:app --reload --host 0.0.0.0 --port 8000
```

### ฑฐ. ุชุณุช!
- ุจุงุฒ ฺฉู: http://localhost:8000/auth/login
- ุดูุงุฑู ุงุฏูู: `09123456789`
- ฺฉุฏ OTP ุฏุฑ ุชุฑููุงู ฺุงูพ ูุดู (ุญุงูุช ุฏุจุงฺฏ)

---

## ๐ ุณุงุฎุชุงุฑ ูพุฑูฺู

```
talamala_v4/
โโโ config/                 # โ๏ธ ุชูุธูุงุช ูุฑฺฉุฒ
โ   โโโ settings.py         # ูุชุบุฑูุง ูุญุท + ุซุงุจุชโูุง
โ   โโโ database.py         # Engine + Session + Base
โ
โโโ common/                 # ๐ง ุงุจุฒุงุฑูุง ูุดุชุฑฺฉ
โ   โโโ exceptions.py       # ุฎุทุงูุง ุณูุงุฑุด
โ   โโโ helpers.py          # ุชูุงุจุน ฺฉูฺฉ (now_utc, format_toman, ...)
โ   โโโ security.py         # JWT, CSRF, OTP
โ   โโโ sms.py              # ุงุฑุณุงู ูพุงูฺฉ (ฺฉุงููโูฺฏุงุฑ)
โ   โโโ templating.py       # ุชูุธูุงุช Jinja2
โ   โโโ upload.py           # ุขูพููุฏ ุชุตุงูุฑ
โ
โโโ modules/
โ   โโโ admin/              # ูุฏูโูุง SystemUser + SystemSetting
โ   โโโ auth/               # ๐ ุงุญุฑุงุฒ ููุช (OTP)
โ   โ   โโโ deps.py         # ูุงุจุณุชฺฏโูุง FastAPI
โ   โ   โโโ routes.py       # ูุฑูุฏุ ุงุฑุณุงู OTPุ ุชุฃุฏุ ุฎุฑูุฌ
โ   โ   โโโ service.py      # ููุทู ุชุฌุงุฑ ุงุญุฑุงุฒ ููุช
โ   โโโ customer/           # ูุฏู ูุดุชุฑ
โ   โโโ [ุจูู ูุงฺููโูุง - ูุงุฒูุง ุจุนุฏ]
โ
โโโ templates/              # ูุงูุจโูุง Jinja2
โโโ static/                 # ูุงูโูุง ุงุณุชุงุชฺฉ
โโโ alembic/                # ูุงฺฏุฑุดู ุฏุชุงุจุณ
โโโ scripts/                # ุงุณฺฉุฑูพุชโูุง ูุฏุฑุช
โโโ main.py                 # ููุทู ุดุฑูุน ุงูพูฺฉุดู
```

---

## ๐บ๏ธ ููุดู ูุงุฒูุง ุขูุฏู

| ูุงุฒ | ูุงฺูู | ุชูุถุญ |
|-----|-------|-------|
| โ ฑ | Setup | ุฒุฑุณุงุฎุชุ configุ common |
| โ ฒ | Auth | ูุฑูุฏ OTPุ ุงุญุฑุงุฒ ููุช |
| โฌ ณ | Catalog | ูุญุตููุงุชุ ุทุฑุญ ฺฉุงุฑุชุ ุจุณุชูโุจูุฏุ ุจฺ |
| โฌ ด | Inventory | ูุฏุฑุช ุดูุด (ุจุงุฑ)ุ ุณุฑุงูุ QR |
| โฌ ต | Shop | ูุฑูุดฺฏุงู ุนููู |
| โฌ ถ | Cart + Orders | ุณุจุฏ ุฎุฑุฏุ ุณูุงุฑุดุ ุฑุฒุฑู |
| โฌ ท | Wallet | ฺฉู ูพููุ ุฏูุชุฑ ฺฉู |
| โฌ ธ | Coupon | ฺฉุฏ ุชุฎูู |
| โฌ น | Payment | ุฏุฑฺฏุงู ูพุฑุฏุงุฎุช |
| โฌ ฑฐ | Verification | ุงุตุงูุชโุณูุฌ QR |
| โฌ ฑฑ | Dealer | ููุงูุฏฺฏุงู + ูฺฉุงูโุงุจ ุดูุด |
| โฌ ฑฒ | Admin | ุฏุงุดุจูุฑุฏ ูุฏุฑุช |
