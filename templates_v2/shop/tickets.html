{% extends "shop/base_shop.html" %}
{% block title %}تیکت‌های پشتیبانی - طلامالا{% endblock %}

{% block shop_content %}
<div class="d-flex align-items-center justify-content-between mb-4 tm-animate-fade-in">
    <h4 class="fw-bold"><i class="bi bi-headset me-2"></i>تیکت‌های پشتیبانی</h4>
    <a href="/tickets/new" class="btn btn-tm-primary">
        <i class="bi bi-plus-lg me-1"></i> تیکت جدید
    </a>
</div>

{% if tickets %}
<div class="card-tm no-hover tm-animate-fade-in-up tm-delay-2">
    <div class="table-responsive">
        <table class="table table-tm align-middle mb-0">
            <thead>
                <tr>
                    <th>#</th>
                    <th>موضوع</th>
                    <th>اولویت</th>
                    <th>وضعیت</th>
                    <th>آخرین بروزرسانی</th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
                {% for t in tickets %}
                <tr>
                    <td class="fw-bold">{{ t.id }}</td>
                    <td>{{ t.subject[:60] }}{% if t.subject|length > 60 %}...{% endif %}</td>
                    <td><span class="badge-tm badge-tm-{{ t.priority_color }}">{{ t.priority_label }}</span></td>
                    <td><span class="badge-tm badge-tm-{{ t.status_color }}">{{ t.status_label }}</span></td>
                    <td><small>{{ t.updated_at | jdate }}</small></td>
                    <td>
                        <a href="/tickets/{{ t.id }}" class="btn btn-sm btn-tm-outline">
                            <i class="bi bi-eye me-1"></i>مشاهده
                        </a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% else %}
<div class="text-center py-5">
    <div style="font-size:4rem;"><i class="bi bi-chat-dots text-muted"></i></div>
    <h5 class="text-muted mt-3">هنوز تیکتی ارسال نکرده‌اید</h5>
    <a href="/tickets/new" class="btn btn-tm-primary mt-2">
        <i class="bi bi-plus-lg me-1"></i> ارسال تیکت جدید
    </a>
</div>
{% endif %}

{% if total_pages > 1 %}
<nav class="mt-3">
    <ul class="pagination pagination-tm justify-content-center">
        {% for p in range(1, total_pages + 1) %}
        <li class="page-item {% if p == page %}active{% endif %}">
            <a class="page-link" href="?page={{ p }}">{{ p }}</a>
        </li>
        {% endfor %}
    </ul>
</nav>
{% endif %}
{% endblock %}
