{% extends "base.html" %}

{% block extra_css %}
<style>
    .img-thumb {
        width: 60px;
        height: 60px;
        object-fit: cover;
        border-radius: 8px;
        border: 2px solid var(--tm-border);
    }
    .img-thumb-lg {
        width: 100px;
        height: 100px;
        object-fit: cover;
        border-radius: 8px;
        border: 2px solid var(--tm-border);
    }
    .default-badge {
        position: absolute;
        top: 4px;
        right: 4px;
        background: var(--tm-primary);
        color: #fff;
        font-size: 0.65rem;
        padding: 2px 6px;
        border-radius: 4px;
    }
</style>
{% block page_css %}{% endblock %}
{% endblock %}

{% block body %}
<!-- Sidebar -->
<nav class="admin-sidebar" id="adminSidebar">
    <div class="sidebar-logo">
        <img src="/static/assets/img/logomark-primary.svg" alt="طلاملا" class="logomark">
        <img src="/static/assets/img/wordmark-primary.svg" alt="طلاملا" class="wordmark">
    </div>
    <div class="mt-2">
        {% if user.has_permission('dashboard') %}
        <a href="/admin/dashboard" class="nav-link {% if active_page == 'dashboard' %}active{% endif %}">
            <i class="bi bi-speedometer2"></i> داشبورد
        </a>
        {% endif %}
        {% if user.has_permission('products') %}
        <a href="/admin/products" class="nav-link {% if active_page == 'products' %}active{% endif %}">
            <i class="bi bi-box-seam"></i> محصولات
        </a>
        <a href="/admin/categories" class="nav-link {% if active_page == 'categories' %}active{% endif %}">
            <i class="bi bi-folder"></i> دسته‌بندی‌ها
        </a>
        <a href="/admin/designs" class="nav-link {% if active_page == 'designs' %}active{% endif %}">
            <i class="bi bi-palette"></i> طرح کارت‌ها
        </a>
        <a href="/admin/packages" class="nav-link {% if active_page == 'packages' %}active{% endif %}">
            <i class="bi bi-gift"></i> بسته‌بندی‌ها
        </a>
        {% endif %}
        {% if user.has_permission('batches') %}
        <a href="/admin/batches" class="nav-link {% if active_page == 'batches' %}active{% endif %}">
            <i class="bi bi-fire"></i> بچ / ذوب
        </a>
        {% endif %}
        {% if user.has_permission('inventory') %}
        <a href="/admin/bars" class="nav-link {% if active_page == 'bars' %}active{% endif %}">
            <i class="bi bi-upc-scan"></i> شمش‌ها
        </a>
        {% endif %}
        {% if user.has_permission('orders') %}
        <a href="/admin/orders" class="nav-link {% if active_page == 'orders' %}active{% endif %}">
            <i class="bi bi-bag-check"></i> سفارشات
        </a>
        {% endif %}
        {% if user.has_permission('customers') %}
        <a href="/admin/customers" class="nav-link {% if active_page == 'customers' %}active{% endif %}">
            <i class="bi bi-people"></i> مدیریت کاربران
        </a>
        {% endif %}
        {% if user.has_permission('wallets') %}
        <a href="/admin/wallets" class="nav-link {% if active_page == 'wallets' %}active{% endif %}">
            <i class="bi bi-wallet2"></i> کیف پول‌ها
        </a>
        <a href="/admin/wallets/withdrawals/list" class="nav-link {% if active_page == 'withdrawals' %}active{% endif %}">
            <i class="bi bi-bank"></i> درخواست برداشت
        </a>
        {% endif %}
        {% if user.has_permission('coupons') %}
        <a href="/admin/coupons" class="nav-link {% if active_page == 'coupons' %}active{% endif %}">
            <i class="bi bi-ticket-perforated"></i> کوپن‌ها
        </a>
        {% endif %}
        {% if user.has_permission('dealers') %}
        <a href="/admin/dealers" class="nav-link {% if active_page == 'dealers' %}active{% endif %}">
            <i class="bi bi-shop"></i> نمایندگان
        </a>
        <a href="/admin/dealers/sales" class="nav-link {% if active_page == 'dealer_sales' %}active{% endif %}">
            <i class="bi bi-receipt-cutoff"></i> فروش نمایندگان
        </a>
        <a href="/admin/dealers/tiers/list" class="nav-link {% if active_page == 'dealer_tiers' %}active{% endif %}">
            <i class="bi bi-layers"></i> سطوح نمایندگان
        </a>
        <a href="/admin/dealers/buybacks" class="nav-link {% if active_page == 'dealer_buybacks' %}active{% endif %}">
            <i class="bi bi-arrow-return-left"></i> بازخرید نمایندگان
        </a>
        <a href="/admin/dealer-requests" class="nav-link {% if active_page == 'dealer_requests' %}active{% endif %}">
            <i class="bi bi-person-plus"></i> درخواست نمایندگی
        </a>
        {% endif %}
        {% if user.has_permission('tickets') %}
        <a href="/admin/tickets" class="nav-link {% if active_page == 'tickets' %}active{% endif %}">
            <i class="bi bi-headset"></i> تیکت‌های پشتیبانی
        </a>
        {% endif %}
        <a href="/admin/reviews" class="nav-link {% if active_page == 'reviews' %}active{% endif %}">
            <i class="bi bi-chat-dots"></i> نظرات و دیدگاه‌ها
        </a>
        {% if user.has_permission('logs') %}
        <a href="/admin/logs" class="nav-link {% if active_page == 'logs' %}active{% endif %}">
            <i class="bi bi-journal-text"></i> لاگ درخواست‌ها
        </a>
        {% endif %}
        <div style="border-top:1px solid var(--tm-border);margin:8px 16px;"></div>
        {% if user.has_permission('staff') %}
        <a href="/admin/staff" class="nav-link {% if active_page == 'staff' %}active{% endif %}">
            <i class="bi bi-person-gear"></i> مدیریت ادمین‌ها
        </a>
        {% endif %}
        {% if user.has_permission('settings') %}
        <a href="/admin/settings" class="nav-link {% if active_page == 'settings' %}active{% endif %}">
            <i class="bi bi-gear"></i> تنظیمات
        </a>
        {% endif %}
        <a href="/auth/logout" class="nav-link" style="color:var(--tm-negative);">
            <i class="bi bi-box-arrow-right"></i> خروج
        </a>
    </div>
</nav>

<!-- Main Content -->
<div class="admin-content">
    <!-- Mobile toggle -->
    <button class="btn btn-sm btn-tm-primary d-lg-none mb-3" onclick="document.getElementById('adminSidebar').classList.toggle('show')">
        <i class="bi bi-list"></i> منو
    </button>

    {% include "components/flash_messages.html" %}
    {% block content %}{% endblock %}
</div>
{% endblock %}

{% block extra_js %}
{% block page_js %}{% endblock %}
{% endblock %}
